/*

 Copyright (c) 2014 Eben Packwood. All rights reserved.
 MIT License


 Copyright (c) 2014 Eben Packwood. All rights reserved.
 MIT License

*/
!function(z){if("object"==typeof exports)module.exports=z();else if("function"==typeof define&&define.amd)define(z);else{var f;"undefined"!=typeof window?f=window:"undefined"!=typeof global?f=global:"undefined"!=typeof self&&(f=self);f.wireframe=z()}}(function(){return function f(q,r,d){function s(g,c){if(!r[g]){if(!q[g]){var k="function"==typeof require&&require;if(!c&&k)return k(g,!0);if(n)return n(g,!0);throw Error("Cannot find module '"+g+"'");}k=r[g]={exports:{}};q[g][0].call(k.exports,function(c){var a=
q[g][1][c];return s(a?a:c)},k,k.exports,f,q,r,d)}return r[g].exports}for(var n="function"==typeof require&&require,p=0;p<d.length;p++)s(d[p]);return s}({1:[function(f,q,r){(function(d){!function(f){if("object"==typeof r)q.exports=f();else{var n;"undefined"!=typeof window?n=window:"undefined"!=typeof d?n=d:"undefined"!=typeof self&&(n=self);n.Colour=f()}}(function(){return function n(d,g,c){function k(a,l){if(!g[a]){if(!d[a]){var b="function"==typeof f&&f;if(!l&&b)return b(a,!0);if(e)return e(a,!0);
throw Error("Cannot find module '"+a+"'");}b=g[a]={exports:{}};d[a][0].call(b.exports,function(b){var c=d[a][1][b];return k(c?c:b)},b,b.exports,n,d,g,c)}return g[a].exports}for(var e="function"==typeof f&&f,a=0;a<c.length;a++)k(c[a]);return k}({1:[function(d,f,g){function c(b,m){var c,t,d={};"string"===typeof b?(b=b.toLowerCase(),b in l?d=l[b]:(d=h(b),l[b]=d),t=d,c=a(d.r,d.g,d.b),m=d.a||m||1):"r"in b?(t=b,c=a(b.r,b.g,b.b),m=c.a||m||1):"h"in b&&(c=b,t=e(b.h,b.s,b.l),m=t.a||m||1);this.rgb={r:t.r,g:t.g,
b:t.b};this.hsl={h:c.h,s:c.s,l:c.l};this.alpha=m;this._color_string=this._toString()}function k(b,m,a){b<m?b=m:b>a&&(b=a);return b}var e,a,h,l;c.prototype.lighten=function(b){var m=this.hsl;b=m.l+b;100<b&&(b=100);return new c({h:m.h,s:m.s,l:b},this.alpha)};c.prototype.darken=function(b){var m=this.hsl;b=m.l-b;0>b&&(b=0);return new c({h:m.h,s:m.s,l:b},this.alpha)};c.prototype.toString=function(){return this._color_string};c.prototype._toString=function(){var b=this.rgb.r.toString(16),m=this.rgb.g.toString(16),
a=this.rgb.b.toString(16);1===b.length&&(b="0"+b);1===m.length&&(m="0"+m);1===a.length&&(a="0"+a);return"#"+b+m+a};e=function(b,m,a){function c(b,m,a){0>a&&(a+=1);1<a&&(a-=1);return a<1/6?b+(m-b)*a*6:.5>a?m:a<2/3?b+(m-b)*(2/3-a)*6:b}var h=a/100,e=m/100;if(0===m)return b=255*h,{r:b,g:b,b:b};m=50>=a?h*(1+e):h+e-h*e;h=2*h-m;b/=360;return{r:Math.round(255*c(h,m,b+1/3)),g:Math.round(255*c(h,m,b)),b:Math.round(255*c(h,m,b-1/3))}};a=function(b,m,a){b/=255;m/=255;a/=255;var c=Math.max(b,m,a),h=Math.min(b,
m,a),e=Math.round((h+c)/2*100);100<e&&(e=100);0>e&&(e=0);var l;if(h===c)return{h:0,s:0,l:e};l=50>=e?(c-h)/(c+h):(c-h)/(2-c-h);var d=(c-b)/(c-h),g=(c-m)/(c-h);a=(c-a)/(c-h);b=(b===c?a-g:m===c?2+d-a:4+g-d)/6%1;0>b&&(b+=1);b=Math.round(360*b);l=Math.round(100*l);360<b&&(b=360);0>b&&(b=0);100<l&&(l=100);0>l&&(l=0);return{h:b,s:l,l:e}};h=function(b){var m,a,c,h=1,l,d=!1;l=b.substr(0,3);if("hsl"===l)(l=/hsla?\(\s*(-?\d+)\s*,\s*(-?\d+)%\s*,\s*(-?\d+)%\s*(,\s*(-?\d+(\.\d+)?)\s*)?\)/g.exec(b))?(m=parseInt(l[1],
10),a=parseInt(l[2],10),c=parseInt(l[3],10),"a"===b[3]&&(h=parseFloat(l[5])),m=Math.abs(m%360),a=k(a,0,100),c=k(c,0,100),l=e(m,a,c),m=l.r,a=l.g,c=l.b):d=!0;else if("rgb"===l)if(l=/rgba?\((-?\d+%?)\s*,\s*(-?\d+%?)\s*,\s*(-?\d+%?)(,\s*(-?\d+(\.\d+)?)\s*)?\)/g.exec(b)){var g=l[1],f=l[2],n=l[3];m=parseInt(l[1],10);a=parseInt(l[2],10);c=parseInt(l[3],10);if("%"===g[g.length-1]||"%"===f[f.length-1]||"%"===n[n.length-1])"%"===g[g.length-1]&&"%"===f[f.length-1]&&"%"===n[n.length-1]?(m=Math.floor(m/100*255),
a=Math.floor(a/100*255),c=Math.floor(c/100*255)):d=!0;m=k(m,0,255);a=k(a,0,255);c=k(c,0,255);"a"===b[3]&&(h=parseFloat(l[5]))}else d=!0;else"#"===b[0]?(l=b.substr(1),3===l.length?(m=parseInt(l[0]+l[0],16),a=parseInt(l[1]+l[1],16),c=parseInt(l[2]+l[2],16)):6===l.length?(m=parseInt(l[0]+l[1],16),a=parseInt(l[2]+l[3],16),c=parseInt(l[4]+l[5],16)):d=!0):d=!0;h=k(h,0,1);if(d)throw"ColourError: Something went wrong. Perhaps "+b+" is not a legal CSS color value";return{r:m,g:a,b:c,a:h}};l={black:{r:0,g:0,
b:0,h:0,s:0,l:0},silver:{r:192,g:192,b:192,h:0,s:0,l:75},gray:{r:128,g:128,b:128,h:0,s:0,l:50},white:{r:255,g:255,b:255,h:0,s:0,l:100},maroon:{r:128,g:0,b:0,h:0,s:100,l:25},red:{r:255,g:0,b:0,h:0,s:100,l:50},purple:{r:128,g:0,b:128,h:300,s:100,l:25},fuchsia:{r:255,g:0,b:255,h:300,s:100,l:50},green:{r:0,g:128,b:0,h:120,s:100,l:25},lime:{r:0,g:255,b:0,h:120,s:100,l:50},olive:{r:128,g:128,b:0,h:60,s:100,l:25},yellow:{r:255,g:255,b:0,h:60,s:100,l:50},navy:{r:0,g:0,b:128,h:240,s:100,l:25},blue:{r:0,g:0,
b:255,h:240,s:100,l:50},teal:{r:0,g:128,b:128,h:180,s:100,l:25},aqua:{r:0,g:255,b:255,h:180,s:100,l:50},orange:{r:255,g:165,b:0,h:39,s:100,l:50},aliceblue:{r:240,g:248,b:255,h:208,s:100,l:97},antiquewhite:{r:250,g:235,b:215,h:34,s:78,l:91},aquamarine:{r:127,g:255,b:212,h:160,s:100,l:75},azure:{r:240,g:255,b:255,h:180,s:100,l:97},beige:{r:245,g:245,b:220,h:60,s:56,l:91},bisque:{r:255,g:228,b:196,h:33,s:100,l:88},blanchedalmond:{r:255,g:235,b:205,h:36,s:100,l:90},blueviolet:{r:138,g:43,b:226,h:271,
s:76,l:53},brown:{r:165,g:42,b:42,h:0,s:59,l:41},burlywood:{r:222,g:184,b:135,h:34,s:57,l:70},cadetblue:{r:95,g:158,b:160,h:182,s:25,l:50},chartreuse:{r:127,g:255,b:0,h:90,s:100,l:50},chocolate:{r:210,g:105,b:30,h:25,s:75,l:47},coral:{r:255,g:127,b:80,h:16,s:100,l:66},cornflowerblue:{r:100,g:149,b:237,h:219,s:79,l:66},cornsilk:{r:255,g:248,b:220,h:48,s:100,l:93},cyan:{r:0,g:255,b:255,h:180,s:100,l:97},crimson:{r:220,g:20,b:60,h:348,s:83,l:47},darkblue:{r:0,g:0,b:139,h:240,s:100,l:27},darkcyan:{r:0,
g:139,b:139,h:180,s:100,l:27},darkgoldenrod:{r:184,g:134,b:11,h:43,s:89,l:38},darkgray:{r:169,g:169,b:169,h:0,s:0,l:66},darkgreen:{r:0,g:100,b:0,h:120,s:100,l:20},darkgrey:{r:169,g:169,b:169,h:0,s:0,l:66},darkkhaki:{r:189,g:183,b:107,h:56,s:38,l:58},darkmagenta:{r:139,g:0,b:139,h:300,s:100,l:27},darkolivegreen:{r:85,g:107,b:47,h:82,s:39,l:30},darkorange:{r:255,g:140,b:0,h:33,s:100,l:50},darkorchid:{r:153,g:50,b:204,h:280,s:61,l:50},darkred:{r:139,g:0,b:0,h:0,s:100,l:27},darksalmon:{r:233,g:150,b:122,
h:15,s:72,l:70},darkseagreen:{r:143,g:188,b:143,h:120,s:25,l:65},darkslateblue:{r:72,g:61,b:139,h:248,s:39,l:39},darkslategray:{r:47,g:79,b:79,h:180,s:25,l:25},darkslategrey:{r:47,g:79,b:79,h:180,s:25,l:25},darkturquoise:{r:0,g:206,b:209,h:181,s:100,l:41},darkviolet:{r:148,g:0,b:211,h:282,s:100,l:41},deeppink:{r:255,g:20,b:147,h:328,s:100,l:54},deepskyblue:{r:0,g:191,b:255,h:195,s:100,l:50},dimgray:{r:105,g:105,b:105,h:0,s:0,l:41},dimgrey:{r:105,g:105,b:105,h:0,s:0,l:41},dodgerblue:{r:30,g:144,b:255,
h:210,s:100,l:56},firebrick:{r:178,g:34,b:34,h:0,s:68,l:42},floralwhite:{r:255,g:250,b:240,h:40,s:100,l:97},forestgreen:{r:34,g:139,b:34,h:120,s:61,l:34},gainsboro:{r:220,g:220,b:220,h:0,s:0,l:86},ghostwhite:{r:248,g:248,b:255,h:240,s:100,l:99},gold:{r:255,g:215,b:0,h:51,s:100,l:50},goldenrod:{r:218,g:165,b:32,h:43,s:74,l:49},greenyellow:{r:173,g:255,b:47,h:84,s:100,l:59},grey:{r:128,g:128,b:128,h:0,s:0,l:50},honeydew:{r:240,g:255,b:240,h:120,s:100,l:97},hotpink:{r:255,g:105,b:180,h:330,s:100,l:71},
indianred:{r:205,g:92,b:92,h:0,s:53,l:58},indigo:{r:75,g:0,b:130,h:275,s:100,l:25},ivory:{r:255,g:255,b:240,h:60,s:100,l:97},khaki:{r:240,g:230,b:140,h:54,s:77,l:75},lavender:{r:230,g:230,b:250,h:240,s:67,l:94},lavenderblush:{r:255,g:240,b:245,h:340,s:100,l:97},lawngreen:{r:124,g:252,b:0,h:90,s:100,l:49},lemonchiffon:{r:255,g:250,b:205,h:54,s:100,l:90},lightblue:{r:173,g:216,b:230,h:195,s:53,l:79},lightcoral:{r:240,g:128,b:128,h:0,s:79,l:72},lightcyan:{r:224,g:255,b:255,h:180,s:100,l:94},lightgoldenrodyellow:{r:250,
g:250,b:210,h:60,s:80,l:90},lightgray:{r:211,g:211,b:211,h:0,s:0,l:83},lightgreen:{r:144,g:238,b:144,h:120,s:73,l:75},lightgrey:{r:211,g:211,b:211,h:0,s:0,l:83},lightpink:{r:255,g:182,b:193,h:351,s:100,l:86},lightsalmon:{r:255,g:160,b:122,h:17,s:100,l:74},lightseagreen:{r:32,g:178,b:170,h:177,s:70,l:41},lightskyblue:{r:135,g:206,b:250,h:203,s:92,l:75},lightslategray:{r:119,g:136,b:153,h:210,s:14,l:53},lightslategrey:{r:119,g:136,b:153,h:210,s:14,l:53},lightsteelblue:{r:176,g:196,b:222,h:214,s:41,
l:78},lightyellow:{r:255,g:255,b:224,h:60,s:100,l:94},limegreen:{r:50,g:205,b:50,h:120,s:61,l:50},linen:{r:250,g:240,b:230,h:30,s:67,l:94},magenta:{r:255,g:0,b:255,h:17,s:100,l:74},mediumaquamarine:{r:102,g:205,b:170,h:160,s:51,l:60},mediumblue:{r:0,g:0,b:205,h:240,s:100,l:40},mediumorchid:{r:186,g:85,b:211,h:288,s:59,l:58},mediumpurple:{r:147,g:112,b:219,h:260,s:60,l:65},mediumseagreen:{r:60,g:179,b:113,h:147,s:50,l:47},mediumslateblue:{r:123,g:104,b:238,h:249,s:80,l:67},mediumspringgreen:{r:0,g:250,
b:154,h:157,s:100,l:49},mediumturquoise:{r:72,g:209,b:204,h:178,s:60,l:55},mediumvioletred:{r:199,g:21,b:133,h:322,s:81,l:43},midnightblue:{r:25,g:25,b:112,h:240,s:64,l:27},mintcream:{r:245,g:255,b:250,h:150,s:100,l:98},mistyrose:{r:255,g:228,b:225,h:6,s:100,l:94},moccasin:{r:255,g:228,b:181,h:38,s:100,l:85},navajowhite:{r:255,g:222,b:173,h:36,s:100,l:84},oldlace:{r:253,g:245,b:230,h:39,s:85,l:95},olivedrab:{r:107,g:142,b:35,h:80,s:60,l:35},orangered:{r:255,g:69,b:0,h:16,s:100,l:50},orchid:{r:218,
g:112,b:214,h:302,s:59,l:65},palegoldenrod:{r:238,g:232,b:170,h:55,s:67,l:80},palegreen:{r:152,g:251,b:152,h:120,s:93,l:79},paleturquoise:{r:175,g:238,b:238,h:180,s:65,l:81},palevioletred:{r:219,g:112,b:147,h:340,s:60,l:65},papayawhip:{r:255,g:239,b:213,h:37,s:100,l:92},peachpuff:{r:255,g:218,b:185,h:28,s:100,l:86},peru:{r:205,g:133,b:63,h:30,s:59,l:53},pink:{r:255,g:192,b:203,h:350,s:100,l:88},plum:{r:221,g:160,b:221,h:300,s:47,l:75},powderblue:{r:176,g:224,b:230,h:187,s:52,l:80},rosybrown:{r:188,
g:143,b:143,h:0,s:25,l:65},royalblue:{r:65,g:105,b:225,h:225,s:73,l:57},saddlebrown:{r:139,g:69,b:19,h:25,s:76,l:31},salmon:{r:250,g:128,b:114,h:6,s:93,l:71},sandybrown:{r:244,g:164,b:96,h:28,s:87,l:67},seagreen:{r:46,g:139,b:87,h:146,s:50,l:36},seashell:{r:255,g:245,b:238,h:25,s:100,l:97},sienna:{r:160,g:82,b:45,h:19,s:56,l:40},skyblue:{r:135,g:206,b:235,h:197,s:71,l:73},slateblue:{r:106,g:90,b:205,h:248,s:53,l:58},slategray:{r:112,g:128,b:144,h:210,s:13,l:50},slategrey:{r:112,g:128,b:144,h:210,
s:13,l:50},snow:{r:255,g:250,b:250,h:0,s:100,l:99},springgreen:{r:0,g:255,b:127,h:150,s:100,l:50},steelblue:{r:70,g:130,b:180,h:207,s:44,l:49},tan:{r:210,g:180,b:140,h:34,s:44,l:69},thistle:{r:216,g:191,b:216,h:300,s:24,l:80},tomato:{r:255,g:99,b:71,h:9,s:100,l:64},turquoise:{r:64,g:224,b:208,h:174,s:72,l:56},violet:{r:238,g:130,b:238,h:300,s:76,l:72},wheat:{r:245,g:222,b:179,h:39,s:77,l:83},whitesmoke:{r:245,g:245,b:245,h:0,s:0,l:96},yellowgreen:{r:154,g:205,b:50,h:80,s:61,l:50}};f.exports=c},{}]},
{},[1])(1)})}).call(this,"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],2:[function(f,q,r){(function(d){!function(f){if("object"==typeof r)q.exports=f();else{var n;"undefined"!=typeof window?n=window:"undefined"!=typeof d?n=d:"undefined"!=typeof self&&(n=self);n.linearalgea=f()}}(function(){return function n(d,g,c){function k(a,l){if(!g[a]){if(!d[a]){var b="function"==typeof f&&f;if(!l&&b)return b(a,!0);if(e)return e(a,!0);throw Error("Cannot find module '"+a+"'");}b=g[a]=
{exports:{}};d[a][0].call(b.exports,function(b){var c=d[a][1][b];return k(c?c:b)},b,b.exports,n,d,g,c)}return g[a].exports}for(var e="function"==typeof f&&f,a=0;a<c.length;a++)k(c[a]);return k}({1:[function(d,f,g){g=d("./vector.js");d=d("./matrix.js");var c=Object.create(null);c.Vector=g;c.Matrix=d;f.exports=c},{"./matrix.js":2,"./vector.js":3}],2:[function(d,f,g){function c(){for(var b=0;16>b;b++)this[b]=0;this.length=16}d=d("./vector.js");c.prototype.equal=function(b){for(var m=0,a=this.length;m<
a;m++)if(this[m]!==b[m])return!1;return!0};c.prototype.add=function(b){for(var m=new c,a=0,h=this.length;a<h;a++)m[a]=this[a]+b[a];return m};c.prototype.addLG=function(b,a){a[0]=this[0]+b[0];a[1]=this[1]+b[1];a[2]=this[2]+b[2];a[3]=this[3]+b[3];a[4]=this[4]+b[4];a[5]=this[5]+b[5];a[6]=this[6]+b[6];a[7]=this[7]+b[7];a[8]=this[8]+b[8];a[9]=this[9]+b[9];a[10]=this[10]+b[10];a[11]=this[11]+b[11];a[12]=this[12]+b[12];a[13]=this[13]+b[13];a[14]=this[14]+b[14];a[15]=this[15]+b[15];return a};c.prototype.subtract=
function(b){for(var a=new c,h=0,e=this.length;h<e;h++)a[h]=this[h]-b[h];return a};c.prototype.subtractLG=function(b,a){a[0]=this[0]-b[0];a[1]=this[1]-b[1];a[2]=this[2]-b[2];a[3]=this[3]-b[3];a[4]=this[4]-b[4];a[5]=this[5]-b[5];a[6]=this[6]-b[6];a[7]=this[7]-b[7];a[8]=this[8]-b[8];a[9]=this[9]-b[9];a[10]=this[10]-b[10];a[11]=this[11]-b[11];a[12]=this[12]-b[12];a[13]=this[13]-b[13];a[14]=this[14]-b[14];a[15]=this[15]-b[15];return a};c.prototype.multiplyScalar=function(b){for(var a=new c,h=0,e=this.length;h<
e;h++)a[h]=this[h]*b;return a};c.prototype.multiplyScalarLG=function(b,a){a[0]=this[0]*b;a[1]=this[1]*b;a[2]=this[2]*b;a[3]=this[3]*b;a[4]=this[4]*b;a[5]=this[5]*b;a[6]=this[6]*b;a[7]=this[7]*b;a[8]=this[8]*b;a[9]=this[9]*b;a[10]=this[10]*b;a[11]=this[11]*b;a[12]=this[12]*b;a[13]=this[13]*b;a[14]=this[14]*b;a[15]=this[15]*b;return a};c.prototype.multiply=function(b){var a=new c;a[0]=this[0]*b[0]+this[1]*b[4]+this[2]*b[8]+this[3]*b[12];a[1]=this[0]*b[1]+this[1]*b[5]+this[2]*b[9]+this[3]*b[13];a[2]=
this[0]*b[2]+this[1]*b[6]+this[2]*b[10]+this[3]*b[14];a[3]=this[0]*b[3]+this[1]*b[7]+this[2]*b[11]+this[3]*b[15];a[4]=this[4]*b[0]+this[5]*b[4]+this[6]*b[8]+this[7]*b[12];a[5]=this[4]*b[1]+this[5]*b[5]+this[6]*b[9]+this[7]*b[13];a[6]=this[4]*b[2]+this[5]*b[6]+this[6]*b[10]+this[7]*b[14];a[7]=this[4]*b[3]+this[5]*b[7]+this[6]*b[11]+this[7]*b[15];a[8]=this[8]*b[0]+this[9]*b[4]+this[10]*b[8]+this[11]*b[12];a[9]=this[8]*b[1]+this[9]*b[5]+this[10]*b[9]+this[11]*b[13];a[10]=this[8]*b[2]+this[9]*b[6]+this[10]*
b[10]+this[11]*b[14];a[11]=this[8]*b[3]+this[9]*b[7]+this[10]*b[11]+this[11]*b[15];a[12]=this[12]*b[0]+this[13]*b[4]+this[14]*b[8]+this[15]*b[12];a[13]=this[12]*b[1]+this[13]*b[5]+this[14]*b[9]+this[15]*b[13];a[14]=this[12]*b[2]+this[13]*b[6]+this[14]*b[10]+this[15]*b[14];a[15]=this[12]*b[3]+this[13]*b[7]+this[14]*b[11]+this[15]*b[15];return a};c.prototype.multiplyLG=function(b,a){a[0]=this[0]*b[0]+this[1]*b[4]+this[2]*b[8]+this[3]*b[12];a[1]=this[0]*b[1]+this[1]*b[5]+this[2]*b[9]+this[3]*b[13];a[2]=
this[0]*b[2]+this[1]*b[6]+this[2]*b[10]+this[3]*b[14];a[3]=this[0]*b[3]+this[1]*b[7]+this[2]*b[11]+this[3]*b[15];a[4]=this[4]*b[0]+this[5]*b[4]+this[6]*b[8]+this[7]*b[12];a[5]=this[4]*b[1]+this[5]*b[5]+this[6]*b[9]+this[7]*b[13];a[6]=this[4]*b[2]+this[5]*b[6]+this[6]*b[10]+this[7]*b[14];a[7]=this[4]*b[3]+this[5]*b[7]+this[6]*b[11]+this[7]*b[15];a[8]=this[8]*b[0]+this[9]*b[4]+this[10]*b[8]+this[11]*b[12];a[9]=this[8]*b[1]+this[9]*b[5]+this[10]*b[9]+this[11]*b[13];a[10]=this[8]*b[2]+this[9]*b[6]+this[10]*
b[10]+this[11]*b[14];a[11]=this[8]*b[3]+this[9]*b[7]+this[10]*b[11]+this[11]*b[15];a[12]=this[12]*b[0]+this[13]*b[4]+this[14]*b[8]+this[15]*b[12];a[13]=this[12]*b[1]+this[13]*b[5]+this[14]*b[9]+this[15]*b[13];a[14]=this[12]*b[2]+this[13]*b[6]+this[14]*b[10]+this[15]*b[14];a[15]=this[12]*b[3]+this[13]*b[7]+this[14]*b[11]+this[15]*b[15];return a};c.prototype.negate=function(){for(var b=new c,a=0,h=this.length;a<h;a++)b[a]=-this[a];return b};c.prototype.negateLG=function(b){b[0]=-this[0];b[1]=-this[1];
b[2]=-this[2];b[3]=-this[3];b[4]=-this[4];b[5]=-this[5];b[6]=-this[6];b[7]=-this[7];b[8]=-this[8];b[9]=-this[9];b[10]=-this[10];b[11]=-this[11];b[12]=-this[12];b[13]=-this[13];b[14]=-this[14];b[15]=-this[15];return b};c.prototype.transpose=function(){var b=new c;b[0]=this[0];b[1]=this[4];b[2]=this[8];b[3]=this[12];b[4]=this[1];b[5]=this[5];b[6]=this[9];b[7]=this[13];b[8]=this[2];b[9]=this[6];b[10]=this[10];b[11]=this[14];b[12]=this[3];b[13]=this[7];b[14]=this[11];b[15]=this[15];return b};c.prototype.transposeLG=
function(b){b[0]=this[0];b[1]=this[4];b[2]=this[8];b[3]=this[12];b[4]=this[1];b[5]=this[5];b[6]=this[9];b[7]=this[13];b[8]=this[2];b[9]=this[6];b[10]=this[10];b[11]=this[14];b[12]=this[3];b[13]=this[7];b[14]=this[11];b[15]=this[15];return b};c.prototype.empty=function(){for(var b=0,a=this.length;b<a;b++)this[b]=0};c.prototype.copy=function(b){for(var a=0;16>a;a++)b[a]=this[a];return b};c.rotationX=function(b){var a=new c,h=Math.cos(b);b=Math.sin(b);a[0]=1;a[5]=h;a[6]=-b;a[9]=b;a[10]=h;a[15]=1;return a};
c.rotationXLG=function(b,a){var c=Math.cos(b),h=Math.sin(b);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=c;a[6]=-h;a[7]=0;a[8]=0;a[9]=h;a[10]=c;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};c.rotationY=function(b){var a=new c,h=Math.cos(b);b=Math.sin(b);a[0]=h;a[2]=b;a[5]=1;a[8]=-b;a[10]=h;a[15]=1;return a};c.rotationYLG=function(b,a){var c=Math.cos(b),h=Math.sin(b);a[0]=c;a[1]=0;a[2]=h;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=-h;a[9]=0;a[10]=c;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};c.rotationZ=
function(b){var a=new c,h=Math.cos(b);b=Math.sin(b);a[0]=h;a[1]=-b;a[4]=b;a[5]=h;a[10]=1;a[15]=1;return a};c.rotationZLG=function(b,a){var c=Math.cos(b),h=Math.sin(b);a[0]=c;a[1]=-h;a[2]=0;a[3]=0;a[4]=h;a[5]=c;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};c.rotationAxis=function(b,a){var h=new c,e=b.normalize(),l=Math.sin(a),d=Math.cos(a),g=1-d,k=e.x,f=e.y,e=e.z,n=k*f,p=k*e,q=f*e;h[0]=d+k*k*g;h[1]=n*g-e*l;h[2]=p*g+f*l;h[4]=n*g+e*l;h[5]=d+f*f*g;h[6]=q*g-k*l;
h[8]=p*g-f*l;h[9]=q*g+k*l;h[10]=d+e*e*g;h[15]=1;return h};c.rotationAxisLG=function(b,a,c){b.normalizeLG(l);b=Math.sin(a);a=Math.cos(a);var h=1-a,e=l.x,d=l.y,g=l.z,k=e*d,f=e*g,n=d*g;c[0]=a+e*e*h;c[1]=k*h-g*b;c[2]=f*h+d*b;c[3]=0;c[4]=k*h+g*b;c[5]=a+d*d*h;c[6]=n*h-e*b;c[7]=0;c[8]=f*h-d*b;c[9]=n*h+e*b;c[10]=a+g*g*h;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};c.rotation=function(b,a,h){return c.rotationX(h).multiply(c.rotationZ(a)).multiply(c.rotationY(b))};c.rotationLG=function(b,l,d,g){c.rotationXLG(d,
k);c.rotationZLG(l,e);c.rotationYLG(b,a);k.multiplyLG(e,h);h.multiplyLG(a,g);return g};c.translation=function(b,a,h){var e=c.identity();e[12]=b;e[13]=a;e[14]=h;return e};c.translationLG=function(a,c,h,e){e[0]=1;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=1;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=1;e[12]=a;e[13]=c;e[14]=h;e[15]=1;return e};c.scale=function(a,h,e){var l=new c;l[0]=a;l[5]=h;l[10]=e;l[15]=1;return l};c.scaleLG=function(a,c,h,e){e[0]=a;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=c;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=
h;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e};c.identity=function(){var a=new c;a[0]=1;a[5]=1;a[10]=1;a[15]=1;return a};c.identityLG=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};c.zero=function(){return new c};c.zeroLG=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=0;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=0;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=0;return a};c.fromArray=function(a){for(var h=new c,e=
0;16>e;e++)h[e]=a[e];return h};c.fromArrayLG=function(a,c){c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];c[9]=a[9];c[10]=a[10];c[11]=a[11];c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c};c.copy=function(a,c){for(var h=0;16>h;h++)c[h]=a[h];return c};var k=new c,e=new c,a=new c,h=new c,l=new d(0,0,0);f.exports=c},{"./vector.js":3}],3:[function(d,f,g){function c(a,c,e){if("undefined"===typeof a||"undefined"===typeof c||"undefined"===typeof e)throw Error("Insufficient arguments.");
this.x=a;this.y=c;this.z=e}c.prototype.add=function(a){return new c(this.x+a.x,this.y+a.y,this.z+a.z)};c.prototype.addLG=function(a,c){c.x=this.x+a.x;c.y=this.y+a.y;c.z=this.z+a.z;return c};c.prototype.subtract=function(a){return new c(this.x-a.x,this.y-a.y,this.z-a.z)};c.prototype.subtractLG=function(a,c){c.x=this.x-a.x;c.y=this.y-a.y;c.z=this.z-a.z;return c};c.prototype.equal=function(a){return this.x===a.x&&this.y===a.y&&this.z===a.z};c.prototype.angle=function(a){var c=this.normalize();a=a.normalize();
var e=c.magnitude(),b=a.magnitude();if(0===e||0===b)return 0;c=c.dot(a)/(e*b);-1>c&&(c=-1);1<c&&(c=1);return Math.acos(c)};c.prototype.angleLG=function(a){this.normalizeLG(k);a.normalizeLG(e);a=k.magnitude();var c=e.magnitude();if(0===a||0===c)return 0;a=k.dot(e)/(a*c);-1>a&&(a=-1);1<a&&(a=1);return Math.acos(a)};c.prototype.cosAngle=function(a){var c=this.normalize();a=a.normalize();var e=c.magnitude(),b=a.magnitude();if(0===e||0===b)return 0;c=c.dot(a)/(e*b);-1>c&&(c=-1);1<c&&(c=1);return c};c.prototype.cosAngleLG=
function(a){this.normalizeLG(k);a.normalizeLG(e);a=k.magnitude();var c=e.magnitude();if(0===a||0===c)return 0;a=k.dot(e)/(a*c);-1>a&&(a=-1);1<a&&(a=1);return a};c.prototype.magnitude=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)};c.prototype.magnitudeSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z};c.prototype.dot=function(a){return this.x*a.x+this.y*a.y+this.z*a.z};c.prototype.cross=function(a){return new c(this.y*a.z-this.z*a.y,this.z*a.x-this.x*a.z,
this.x*a.y-this.y*a.x)};c.prototype.crossLG=function(a,c){c.x=this.y*a.z-this.z*a.y;c.y=this.z*a.x-this.x*a.z;c.z=this.x*a.y-this.y*a.x;return c};c.prototype.normalize=function(){var a=this.magnitude();return 0===a?new c(this.x,this.y,this.z):new c(this.x/a,this.y/a,this.z/a)};c.prototype.normalizeLG=function(a){var c=this.magnitude();0===c&&(a.x=this.x,a.y=this.y,a.z=this.z);a.x=this.x/c;a.y=this.y/c;a.z=this.z/c;return a};c.prototype.scale=function(a){return new c(this.x*a,this.y*a,this.z*a)};c.prototype.scaleLG=
function(a,c){c.x=this.x*a;c.y=this.y*a;c.z=this.z*a;return c};c.prototype.negate=function(){return new c(-this.x,-this.y,-this.z)};c.prototype.negateLG=function(a){a.x=-this.x;a.y=-this.y;a.z=-this.z;return a};c.prototype.vectorProjection=function(a){var c=a.magnitude();return a.scale(this.dot(a)/(c*c))};c.prototype.vectorProjectionLG=function(a,c){var e=a.magnitude();a.scaleLG(this.dot(a)/(e*e),c);return c};c.prototype.scalarProjection=function(a){return this.dot(a)/a.magnitude()};c.prototype.transform=
function(a){var e=this.x*a[3]+this.y*a[7]+this.z*a[11]+a[15];return new c((this.x*a[0]+this.y*a[4]+this.z*a[8]+a[12])/e,(this.x*a[1]+this.y*a[5]+this.z*a[9]+a[13])/e,(this.x*a[2]+this.y*a[6]+this.z*a[10]+a[14])/e)};c.prototype.transformLG=function(a,c){var e=this.x*a[1]+this.y*a[5]+this.z*a[9]+a[13],b=this.x*a[2]+this.y*a[6]+this.z*a[10]+a[14],d=this.x*a[3]+this.y*a[7]+this.z*a[11]+a[15];c.x=(this.x*a[0]+this.y*a[4]+this.z*a[8]+a[12])/d;c.y=e/d;c.z=b/d;return c};c.prototype.rotate=function(a,e){var l=
a.normalize(),b=Math.sin(e),d=Math.cos(e),g=1-d,f=l.x,k=l.y,n=l.z,p=l.x*l.y,q=l.x*l.z,l=l.y*l.z;return new c((d+f*f*g)*this.x+(p*g-n*b)*this.y+(q*g+k*b)*this.z,(p*g+n*b)*this.x+(d+k*k*g)*this.y+(l*g-f*b)*this.z,(q*g-k*b)*this.x+(l*g+f*b)*this.y+(d+f*f*g)*this.z)};c.prototype.rotateLG=function(a,c,e){a.normalizeLG(e);a=Math.sin(c);c=Math.cos(c);var b=1-c,d=e.x,g=e.y,f=e.z,k=e.x*e.y,n=e.x*e.z,p=e.y*e.z,q=(k*b+f*a)*this.x+(c+g*g*b)*this.y+(p*b-d*a)*this.z,p=(n*b-g*a)*this.x+(p*b+d*a)*this.y+(c+d*d*b)*
this.z;e.x=(c+d*d*b)*this.x+(k*b-f*a)*this.y+(n*b+g*a)*this.z;e.y=q;e.z=p;return e};c.prototype.rotateX=function(a){var e=Math.sin(a);a=Math.cos(a);return new c(this.x,a*this.y-e*this.z,e*this.y+a*this.z)};c.prototype.rotateXLG=function(a,c){var e=Math.sin(a),b=Math.cos(a),d=b*this.y-e*this.z,e=e*this.y+b*this.z;c.x=this.x;c.y=d;c.z=e;return c};c.prototype.rotateY=function(a){var e=Math.sin(a);a=Math.cos(a);return new c(a*this.x+e*this.z,this.y,-(e*this.x)+a*this.z)};c.prototype.rotateYLG=function(a,
c){var e=Math.sin(a),b=Math.cos(a),d=this.y,g=-(e*this.x)+b*this.z;c.x=b*this.x+e*this.z;c.y=d;c.z=g;return c};c.prototype.rotateZ=function(a){var e=Math.sin(a);a=Math.cos(a);return new c(a*this.x-e*this.y,e*this.x+a*this.y,this.z)};c.prototype.rotateZLG=function(a,c){var e=Math.sin(a),b=Math.cos(a),d=e*this.x+b*this.y,g=this.z;c.x=b*this.x-e*this.y;c.y=d;c.z=g;return c};c.prototype.rotatePitchYawRoll=function(a,c,e){return this.rotateX(e).rotateY(a).rotateZ(c)};c.prototype.rotatePitchYawRollLG=function(a,
c,e,b){this.rotateXLG(e,b);b.rotateYLG(a,b);b.rotateZLG(c,b);return b};var k=new c(0,0,0),e=new c(0,0,0);f.exports=c},{}]},{},[1])(1)})}).call(this,"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],3:[function(f,q,r){function d(d,c,f){this.position=f||new s(1,1,20);this.up=new s(0,1,0);this.rotation={yaw:0,pitch:0,roll:0};this.view_matrix=new n;this.width=d;this.height=c;this.near=.1;this.far=1E3;this.fov=90;this.perspectiveFov=new n;this._xaxis=new s(0,0,0);this._yaxis=new s(0,
0,0);this._zaxis=new s(0,0,0);this._direction=new s(0,0,0);this._temp_vector1=new s(0,0,0);this._temp_vector2=new s(0,0,0);this._temp_matrix=new n;this.calculatePerspectiveFov();this.createViewMatrix()}f=f("linearalgea");var s=f.Vector,n=f.Matrix,p=2*Math.PI;d.prototype.direction=function(){var d=Math.sin(this.rotation.pitch),c=Math.cos(this.rotation.pitch),f=Math.sin(this.rotation.yaw),e=Math.cos(this.rotation.yaw);this._direction.x=-c*f;this._direction.y=d;this._direction.z=-c*e};d.prototype.calculatePerspectiveFov=
function(){var d=this.width/this.height,c=this.near,f=this.far,e=1/Math.tan(Math.PI/180*this.fov/2)*this.height;this.perspectiveFov[0]=e*d;this.perspectiveFov[5]=e;this.perspectiveFov[10]=f/(c-f);this.perspectiveFov[11]=-1;this.perspectiveFov[14]=c*f/(c-f)};d.prototype.createViewMatrix=function(){var d=this.position,c=this.rotation.pitch,f=this.rotation.yaw,e=Math.cos(c),c=Math.sin(c),a=Math.cos(f),f=Math.sin(f);this._xaxis.x=a;this._xaxis.y=0;this._xaxis.z=-f;this._yaxis.x=f*c;this._yaxis.y=e;this._yaxis.z=
a*c;this._zaxis.x=f*e;this._zaxis.y=-c;this._zaxis.z=e*a;n.fromArrayLG([this._xaxis.x,this._yaxis.x,this._zaxis.x,0,this._xaxis.y,this._yaxis.y,this._zaxis.y,0,this._xaxis.z,this._yaxis.z,this._zaxis.z,0,-this._xaxis.dot(d),-this._yaxis.dot(d),-this._zaxis.dot(d),1],this.view_matrix)};d.prototype.look=function(d,c){this.rotation.yaw-=d;0>this.rotation.yaw?this.rotation.yaw+=p:this.rotation.yaw>p&&(this.rotation.yaw-=p);this.rotation.pitch-=c;0>this.rotation.pitch?this.rotation.pitch+=p:this.rotation.pitch>
p&&(this.rotation.pitch-=p);this.createViewMatrix()};d.prototype.turnRight=function(d){this.rotation.yaw-=d;0>this.rotation.yaw&&(this.rotation.yaw+=p);this.createViewMatrix()};d.prototype.turnLeft=function(d){this.rotation.yaw+=d;this.rotation.yaw>p&&(this.rotation.yaw-=p);this.createViewMatrix()};d.prototype.lookUp=function(d){this.rotation.pitch-=d;this.rotation.pitch>p&&(this.rotation.pitch-=p);this.createViewMatrix()};d.prototype.lookDown=function(d){this.rotation.pitch+=d;0>this.rotation.pitch&&
(this.rotation.pitch+=p);this.createViewMatrix()};d.prototype.moveTo=function(d,c,f){this.position.x=d;this.position.y=c;this.position.z=f;this.createViewMatrix()};d.prototype.move=function(d,c,f){this.position.x+=d;this.position.y+=c;this.position.z+=f;this.createViewMatrix()};d.prototype.moveRight=function(d){this.direction();this._direction.normalizeLG(this._temp_vector1);this._temp_vector1.scaleLG(d,this._temp_vector2);this.up.crossLG(this._temp_vector2,this._temp_vector1);this.position.subtractLG(this._temp_vector1,
this.position);this.createViewMatrix()};d.prototype.moveLeft=function(d){this.direction();this._direction.normalizeLG(this._temp_vector1);this._temp_vector1.scaleLG(d,this._temp_vector2);this.up.crossLG(this._temp_vector2,this._temp_vector1);this.position.addLG(this._temp_vector1,this.position);this.createViewMatrix()};d.prototype.moveUp=function(d){this.up.normalizeLG(this._temp_vector1);this._temp_vector1.scaleLG(d,this._temp_vector2);this.position.subtractLG(this._temp_vector2,this.position);this.createViewMatrix()};
d.prototype.moveDown=function(d){this.up.normalizeLG(this._temp_vector1);this._temp_vector1.scaleLG(d,this._temp_vector2);this.position.addLG(this._temp_vector2,this.position);this.createViewMatrix()};d.prototype.moveForward=function(d){this.direction();this._direction.normalizeLG(this._temp_vector1);this._temp_vector1.scaleLG(d,this._temp_vector2);this.position.addLG(this._temp_vector2,this.position);this.createViewMatrix()};d.prototype.moveBackward=function(d){this.direction();this._direction.normalizeLG(this._temp_vector1);
this._temp_vector1.scaleLG(d,this._temp_vector2);this.position.subtractLG(this._temp_vector2,this.position);this.createViewMatrix()};q.exports=d},{linearalgea:2}],4:[function(f,q,r){r=f("./scene.js");f=f("./camera.js");q.exports.Scene=r;q.exports.Camera=f},{"./camera.js":3,"./scene.js":6}],5:[function(f,q,r){q.exports={_listeners:{},addListener:function(d,f){d in this._listeners||(this._listeners[d]=[]);this._listeners[d].push(f)},fire:function(d,f){var n={};"undefined"!==typeof f&&(n=f);n.event=
d;n.target=this;var p=this._listeners[d];if("undefined"!==typeof p)for(var g=0,c=p.length;g<c;g++)p[g].call(this,n)},removeListener:function(d,f){for(var n=this._listeners[d],p=0,g=n.length;p<g;p++)n[p]===f&&n.splice(p,1)}}},{}],6:[function(f,q,r){function d(e){this.width=e.width;this.height=e.height;this.canvas=document.getElementById(e.canvas_id);this.ctx=this.canvas.getContext("2d");this.ctx.strokeStyle="red";this.camera=new s(this.width,this.height);this.illumination=new c(90,0,0);this.meshes=
{};this._x_offset=Math.round(this.width/2);this._y_offset=Math.round(this.height/2);this._back_buffer=document.createElement("canvas");this._back_buffer.width=this.width;this._back_buffer.height=this.height;this._back_buffer_ctx=this._back_buffer.getContext("2d");this._back_buffer_image=null;this._depth_buffer=[];this._backface_culling=!0;this._quickdraw=!1;this._keys={};this._key_count=0;this._anim_id=null;this._needs_update=!0;this._draw_mode=0;this.canvas.tabIndex=1;this._back_buffer_image=this._back_buffer_ctx.createImageData(this.width,
this.height);this.canvas.addEventListener("keydown",this.onKeyDown.bind(this),!1);this.canvas.addEventListener("keyup",this.onKeyUp.bind(this),!1);this.canvas.addEventListener("blur",this.emptyKeys.bind(this),!1);this.canvas.addEventListener("mousedown",this.onMouseDown.bind(this),!1);this.canvas.addEventListener("mouseup",this.onMouseUp.bind(this),!1);this.canvas.addEventListener("mousemove",this.onMouseMove.bind(this),!1);this.initializeDepthBuffer();this.update();this._light_direction=new c(0,
0,0);this._wv1=new c(0,0,0);this._wv2=new c(0,0,0);this._wv3=new c(0,0,0);this._v1=new c(0,0,0);this._v2=new c(0,0,0);this._v3=new c(0,0,0);this._v1t=new c(0,0,0);this._v2t=new c(0,0,0);this._v3t=new c(0,0,0);this._wvp_matrix=new k;this._world_matrix=new k;this._rotation_matrix=new k;this._translation_matrix=new k;this._scale_matrix=new k;this._cam_to_vert=new c(0,0,0);this._temp_matrix=new k;this._side1=new c(0,0,0);this._side2=new c(0,0,0);this._norm=new c(0,0,0)}r=f("linearalgea");var s=f("./camera.js"),
n=f("./events.js"),p=f("../utilities/mixin.js"),g=f("../utilities/keycodes.js"),c=r.Vector,k=r.Matrix;p(d.prototype,n);d.prototype.emptyKeys=function(){this._key_count=0;this._keys={}};d.prototype.isKeyDown=function(c){c=g[c];return c in this._keys&&this._keys[c]};d.prototype.onKeyDown=function(c){c=c.keyCode||c.which;this.isKeyDown(c)||(this._key_count+=1,this._keys[c]=!0)};d.prototype.onKeyUp=function(c){c=c.keyCode||c.which;c in this._keys&&(this._key_count-=1,this._keys[c]=!1)};d.prototype._getMousePos=
function(c){var a=this.canvas.getBoundingClientRect();return{x:c.clientX-a.left,y:c.clientY-a.top}};d.prototype.onMouseDown=function(c){this._last_mouse_update=this._last_mouse_coords=void 0;c={mouse:this._getMousePos(c)};this.fire("mousedown",c);var a=this.onMouseDrag.bind(this),d=function(){this.removeEventListener("mousemove",a,!1);this.removeEventListener("mouseup",d,!1);this._last_mouse_update=this._last_mouse_coords=void 0};this.canvas.addEventListener("mousemove",a,!1);this.canvas.addEventListener("mouseup",
d,!1);this.canvas.addEventListener("mouseleave",d,!1)};d.prototype.onMouseUp=function(c){c={mouse:this._getMousePos(c)};this.fire("mouseup",c)};d.prototype.onMouseMove=function(c){c={mouse:this._getMousePos(c)};this.fire("mousemove",c)};d.prototype.onMouseDrag=function(c){c=this._getMousePos(c);"undefined"===typeof this._last_mouse_coords&&(this._last_mouse_coords=c);"undefined"===typeof this._last_mouse_update&&(this._last_mouse_update=new Date);var a=new Date-this._last_mouse_update,d=c.x-this._last_mouse_coords.x,
f=c.y-this._last_mouse_coords.y,b=0,m=0;0<a&&(b=d/a,m=f/a);d={mouse:{x:c.x,y:c.y,xvel:b,yvel:m,deltax:d,deltay:f}};this._last_mouse_coords=c;this._last_mouse_update=a;this.fire("mousedrag",d)};d.prototype.initializeDepthBuffer=function(){for(var c=0,a=this.width*this.height;c<a;c++)this._depth_buffer[c]=9999999};d.prototype._clear_back_buffer_image=function(){for(var c=this._back_buffer_image.data,a=3;a<c.length;a+=4)c[a]=0};d.prototype.offscreen=function(c){var a=c.x+this._x_offset,d=c.y+this._y_offset;
return 1<c.z||0>a||a>this.width||0>d||d>this.height};d.prototype.toggleDrawMode=function(){this._draw_mode=(this._draw_mode+1)%2;this.renderScene()};d.prototype.toggleBackfaceCulling=function(){this._backface_culling=!this._backface_culling;this.renderScene()};d.prototype.toggleQuickDraw=function(){this._quickdraw=!this._quickdraw;this.renderScene()};d.prototype.drawPixel=function(c,a,d,f){c+=this._x_offset;a+=this._y_offset;if(0<=c&&c<this.width&&0<=a&&a<this.height&&(c+=a*this.width,d<this._depth_buffer[c])){a=
this._back_buffer_image.data;var b=4*c;a[b]=f.rgb.r;a[b+1]=f.rgb.g;a[b+2]=f.rgb.b;a[b+3]=255;this._depth_buffer[c]=d}};d.prototype.drawEdge=function(c,a,d){var f=Math.abs;if(c.x>=a.x){var b=c;c=a;a=b}var b=c.x,m=c.y,g=c.z,f=Math.max(f(a.x-c.x),f(a.y-c.y),f(a.z-c.z)),k=(a.x-c.x)/f,n=(a.y-c.y)/f;c=(a.z-c.z)/f;for(a=0;a<f;a++)this.drawPixel(Math.floor(b),Math.floor(m),g,d),b+=k,m+=n,g+=c};d.prototype.quickLine=function(c,a){var d=Math.round(c.x+this._x_offset),f=Math.round(c.y+this._y_offset),b=Math.round(a.x+
this._x_offset),m=Math.round(a.y+this._y_offset);this.ctx.moveTo(d,f);this.ctx.lineTo(b,m)};d.prototype.drawTriangle=function(c,a,d,f){this._quickdraw?(this.quickLine(c,a),this.quickLine(a,d),this.quickLine(d,c)):(this.drawEdge(c,a,f),this.drawEdge(a,d,f),this.drawEdge(d,c,f))};d.prototype.fillTriangle=function(c,a,d,f){var b=c.x,m=a.x,g=d.x,k=c.y,n=a.y,p=d.y;c=c.z;a=a.z;d=d.z;var q=0-this._x_offset,r=this.width-this._x_offset,s=0-this._y_offset,u=this.height-this._y_offset,v=Math.floor(Math.min(b,
m,g));v<q&&(v=q);q=Math.ceil(Math.max(b,m,g));q>r&&(q=r);r=Math.floor(Math.min(k,n,p));r<s&&(r=s);s=Math.ceil(Math.max(k,n,p));s>u&&(s=u);for(var A=p-k,y=b-g,w=k-n,u=m-b,x=g*k-b*p,b=b*n-m*k,m=A*m+y*n+x,k=w*g+u*p+b,g=A/m,p=y/m,m=x/m,n=w/k,u=u/k,b=b/k;v<=q;v++)for(k=r;k<=s;k++)w=g*v+p*k+m,0<=w&&1>=w&&(x=n*v+u*k+b,0<=x&&1>=x&&(y=1-w-x,0<=y&&1>=y&&this.drawPixel(v,k,y*c+w*a+x*d,f)))};d.prototype.renderScene=function(){this._quickdraw&&0===this._draw_mode?(this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),
this.ctx.beginPath()):(this._clear_back_buffer_image(),this.initializeDepthBuffer());var c=this.camera.view_matrix,a=this.camera.perspectiveFov,d=this.illumination,f;for(f in this.meshes)if(this.meshes.hasOwnProperty(f)){var b=this.meshes[f],g=b.scale,n=b.rotation,p=b.position;k.scaleLG(g.x,g.y,g.z,this._scale_matrix);k.rotationLG(n.pitch,n.yaw,n.roll,this._rotation_matrix);k.translationLG(p.x,p.y,p.z,this._translation_matrix);this._scale_matrix.multiplyLG(this._rotation_matrix,this._world_matrix);
this._world_matrix.multiplyLG(this._translation_matrix,this._world_matrix);for(g=0;g<b.faces.length;g++){var q=b.faces[g].face,n=b.faces[g].color,p=b.vertices[q[0]],r=b.vertices[q[1]],q=b.vertices[q[2]];p.transformLG(this._world_matrix,this._v1t);r.transformLG(this._world_matrix,this._v2t);q.transformLG(this._world_matrix,this._v3t);this.camera.position.subtractLG(this._v1t,this._cam_to_vert);this._v2t.subtractLG(this._v1t,this._side1);this._v3t.subtractLG(this._v1t,this._side2);this._side1.crossLG(this._side2,
this._norm);1E-8<=this._norm.magnitude()&&this._norm.normalizeLG(this._norm);if(!this._backface_culling||0<=this._cam_to_vert.dot(this._norm))this._world_matrix.multiplyLG(c,this._temp_matrix),this._temp_matrix.multiplyLG(a,this._wvp_matrix),p.transformLG(this._wvp_matrix,this._wv1),r.transformLG(this._wvp_matrix,this._wv2),q.transformLG(this._wvp_matrix,this._wv3),p=!0,this.offscreen(this._wv1)&&this.offscreen(this._wv2)&&this.offscreen(this._wv3)&&(p=!1),p&&(0===this._draw_mode?this.drawTriangle(this._wv1,
this._wv2,this._wv3,n):1===this._draw_mode&&(d.subtractLG(this._v1t,this._light_direction),this._light_direction.normalizeLG(this._light_direction),p=this._norm.dot(this._light_direction),n=n.lighten(15*p),this.fillTriangle(this._wv1,this._wv2,this._wv3,n)))}}this._quickdraw&&0===this._draw_mode?(this.ctx.stroke(),this.ctx.closePath()):(this._back_buffer_ctx.putImageData(this._back_buffer_image,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.drawImage(this._back_buffer,
0,0,this.canvas.width,this.canvas.height))};d.prototype.addMesh=function(c){this.meshes[c.name]=c};d.prototype.removeMesh=function(c){delete this.meshes[c.name]};d.prototype.update=function(){0<this._key_count&&this.fire("keydown");this._needs_update&&(this.renderScene(),this._needs_update=!1);this._anim_id=window.requestAnimationFrame(this.update.bind(this))};q.exports=d},{"../utilities/keycodes.js":11,"../utilities/mixin.js":12,"./camera.js":3,"./events.js":5,linearalgea:2}],7:[function(f,q,r){r=
f("./geometry/geometry.js");f=f("./engine/engine.js");q.exports.geometry=r;q.exports.engine=f},{"./engine/engine.js":4,"./geometry/geometry.js":9}],8:[function(f,q,r){var d=f("colour");q.exports=function(f,n,p,g){this.face=[f,n,p];this.color=new d(g)}},{colour:1}],9:[function(f,q,r){r=f("./mesh.js");f=f("./face.js");q.exports.Mesh=r;q.exports.Face=f},{"./face.js":8,"./mesh.js":10}],10:[function(f,q,r){function d(d,f,c){this.name=d;this.vertices=f;this.faces=c;this.position=new s(0,0,0);this.rotation=
{yaw:0,pitch:0,roll:0};this.scale={x:1,y:1,z:1}}var s=f("linearalgea").Vector,n=f("./face.js");d.fromJSON=function(f){for(var g=[],c=[],k=0,e=f.vertices.length;k<e;k++){var a=f.vertices[k];g.push(new s(a[0],a[1],a[2]))}k=0;for(e=f.faces.length;k<e;k++)a=f.faces[k],c.push(new n(a.face[0],a.face[1],a.face[2],a.color));return new d(f.name,g,c)};q.exports=d},{"./face.js":8,linearalgea:2}],11:[function(f,q,r){q.exports={space:32,backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause_break:19,caps_lock:20,
escape:27,page_up:33,"page down":34,end:35,home:36,left_arrow:37,up_arrow:38,right_arrow:39,down_arrow:40,insert:45,"delete":46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,"left_window key":91,"right_window key":92,select_key:93,"numpad 0":96,"numpad 1":97,"numpad 2":98,"numpad 3":99,"numpad 4":100,"numpad 5":101,"numpad 6":102,"numpad 7":103,"numpad 8":104,"numpad 9":105,
multiply:106,add:107,subtract:109,"decimal point":110,divide:111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,num_lock:144,scroll_lock:145,semi_colon:186,equal_sign:187,comma:188,dash:189,period:190,forward_slash:191,grave_accent:192,open_bracket:219,backslash:220,closebracket:221,single_quote:222}},{}],12:[function(f,q,r){q.exports=function(d,f){for(var n in f)f.hasOwnProperty(n)&&(d[n]=f[n]);return d}},{}]},{},[7])(7)});
