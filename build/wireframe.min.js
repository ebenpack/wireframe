/*

 Copyright (c) 2014 Eben Packwood. All rights reserved.
 MIT License


 Copyright (c) 2014 Eben Packwood. All rights reserved.
 MIT License

*/
!function(z){if("object"==typeof exports)module.exports=z();else if("function"==typeof define&&define.amd)define(z);else{var f;"undefined"!=typeof window?f=window:"undefined"!=typeof global?f=global:"undefined"!=typeof self&&(f=self);f.wireframe=z()}}(function(){return function f(q,r,e){function s(h,c){if(!r[h]){if(!q[h]){var k="function"==typeof require&&require;if(!c&&k)return k(h,!0);if(l)return l(h,!0);throw Error("Cannot find module '"+h+"'");}k=r[h]={exports:{}};q[h][0].call(k.exports,function(c){var a=
q[h][1][c];return s(a?a:c)},k,k.exports,f,q,r,e)}return r[h].exports}for(var l="function"==typeof require&&require,p=0;p<e.length;p++)s(e[p]);return s}({1:[function(f,q,r){(function(e){!function(f){if("object"==typeof r)q.exports=f();else{var l;"undefined"!=typeof window?l=window:"undefined"!=typeof e?l=e:"undefined"!=typeof self&&(l=self);l.Colour=f()}}(function(){return function l(e,h,c){function k(a,m){if(!h[a]){if(!e[a]){var b="function"==typeof f&&f;if(!m&&b)return b(a,!0);if(g)return g(a,!0);
throw Error("Cannot find module '"+a+"'");}b=h[a]={exports:{}};e[a][0].call(b.exports,function(b){var c=e[a][1][b];return k(c?c:b)},b,b.exports,l,e,h,c)}return h[a].exports}for(var g="function"==typeof f&&f,a=0;a<c.length;a++)k(c[a]);return k}({1:[function(e,f,h){function c(b,n){var c,t,e={};"string"===typeof b?(b=b.toLowerCase(),b in m?e=m[b]:(e=d(b),m[b]=e),t=e,c=a(e.r,e.g,e.b),n=e.a||n||1):"r"in b?(t=b,c=a(b.r,b.g,b.b),n=c.a||n||1):"h"in b&&(c=b,t=g(b.h,b.s,b.l),n=t.a||n||1);this.rgb={r:t.r,g:t.g,
b:t.b};this.hsl={h:c.h,s:c.s,l:c.l};this.alpha=n}function k(b,n,a){b<n?b=n:b>a&&(b=a);return b}var g,a,d,m;c.prototype.lighten=function(b){var n=this.hsl;b=n.l+b;100<b&&(b=100);return new c({h:n.h,s:n.s,l:b},this.alpha)};c.prototype.darken=function(b){var n=this.hsl;b=n.l-b;0>b&&(b=0);return new c({h:n.h,s:n.s,l:b},this.alpha)};c.prototype.toString=function(){var b=this.rgb.r.toString(16),n=this.rgb.g.toString(16),a=this.rgb.b.toString(16);1===b.length&&(b="0"+b);1===n.length&&(n="0"+n);1===a.length&&
(a="0"+a);return"#"+b+n+a};g=function(b,n,a){function c(b,n,a){0>a&&(a+=1);1<a&&(a-=1);return a<1/6?b+(n-b)*a*6:.5>a?n:a<2/3?b+(n-b)*(2/3-a)*6:b}var d=a/100,g=n/100;if(0===n)return b=255*d,{r:b,g:b,b:b};n=50>=a?d*(1+g):d+g-d*g;d=2*d-n;b/=360;return{r:Math.round(255*c(d,n,b+1/3)),g:Math.round(255*c(d,n,b)),b:Math.round(255*c(d,n,b-1/3))}};a=function(b,n,a){b/=255;n/=255;a/=255;var c=Math.max(b,n,a),d=Math.min(b,n,a),g=Math.round((d+c)/2*100);100<g&&(g=100);0>g&&(g=0);var m;if(d===c)return{h:0,s:0,
l:g};m=50>=g?(c-d)/(c+d):(c-d)/(2-c-d);var e=(c-b)/(c-d),h=(c-n)/(c-d);a=(c-a)/(c-d);b=(b===c?a-h:n===c?2+e-a:4+h-e)/6%1;0>b&&(b+=1);b=Math.round(360*b);m=Math.round(100*m);360<b&&(b=360);0>b&&(b=0);100<m&&(m=100);0>m&&(m=0);return{h:b,s:m,l:g}};d=function(b){var n,a,c,d=1,m,e=!1;m=b.substr(0,3);if("hsl"===m)(m=/hsla?\(\s*(-?\d+)\s*,\s*(-?\d+)%\s*,\s*(-?\d+)%\s*(,\s*(-?\d+(\.\d+)?)\s*)?\)/g.exec(b))?(n=parseInt(m[1],10),a=parseInt(m[2],10),c=parseInt(m[3],10),"a"===b[3]&&(d=parseFloat(m[5])),n=Math.abs(n%
360),a=k(a,0,100),c=k(c,0,100),m=g(n,a,c),n=m.r,a=m.g,c=m.b):e=!0;else if("rgb"===m)if(m=/rgba?\((-?\d+%?)\s*,\s*(-?\d+%?)\s*,\s*(-?\d+%?)(,\s*(-?\d+(\.\d+)?)\s*)?\)/g.exec(b)){var h=m[1],f=m[2],l=m[3];n=parseInt(m[1],10);a=parseInt(m[2],10);c=parseInt(m[3],10);if("%"===h[h.length-1]||"%"===f[f.length-1]||"%"===l[l.length-1])"%"===h[h.length-1]&&"%"===f[f.length-1]&&"%"===l[l.length-1]?(n=Math.floor(n/100*255),a=Math.floor(a/100*255),c=Math.floor(c/100*255)):e=!0;n=k(n,0,255);a=k(a,0,255);c=k(c,0,
255);"a"===b[3]&&(d=parseFloat(m[5]))}else e=!0;else"#"===b[0]?(m=b.substr(1),3===m.length?(n=parseInt(m[0]+m[0],16),a=parseInt(m[1]+m[1],16),c=parseInt(m[2]+m[2],16)):6===m.length?(n=parseInt(m[0]+m[1],16),a=parseInt(m[2]+m[3],16),c=parseInt(m[4]+m[5],16)):e=!0):e=!0;d=k(d,0,1);if(e)throw"ColourError: Something went wrong. Perhaps "+b+" is not a legal CSS color value";return{r:n,g:a,b:c,a:d}};m={black:{r:0,g:0,b:0,h:0,s:0,l:0},silver:{r:192,g:192,b:192,h:0,s:0,l:75},gray:{r:128,g:128,b:128,h:0,s:0,
l:50},white:{r:255,g:255,b:255,h:0,s:0,l:100},maroon:{r:128,g:0,b:0,h:0,s:100,l:25},red:{r:255,g:0,b:0,h:0,s:100,l:50},purple:{r:128,g:0,b:128,h:300,s:100,l:25},fuchsia:{r:255,g:0,b:255,h:300,s:100,l:50},green:{r:0,g:128,b:0,h:120,s:100,l:25},lime:{r:0,g:255,b:0,h:120,s:100,l:50},olive:{r:128,g:128,b:0,h:60,s:100,l:25},yellow:{r:255,g:255,b:0,h:60,s:100,l:50},navy:{r:0,g:0,b:128,h:240,s:100,l:25},blue:{r:0,g:0,b:255,h:240,s:100,l:50},teal:{r:0,g:128,b:128,h:180,s:100,l:25},aqua:{r:0,g:255,b:255,h:180,
s:100,l:50},orange:{r:255,g:165,b:0,h:39,s:100,l:50},aliceblue:{r:240,g:248,b:255,h:208,s:100,l:97},antiquewhite:{r:250,g:235,b:215,h:34,s:78,l:91},aquamarine:{r:127,g:255,b:212,h:160,s:100,l:75},azure:{r:240,g:255,b:255,h:180,s:100,l:97},beige:{r:245,g:245,b:220,h:60,s:56,l:91},bisque:{r:255,g:228,b:196,h:33,s:100,l:88},blanchedalmond:{r:255,g:235,b:205,h:36,s:100,l:90},blueviolet:{r:138,g:43,b:226,h:271,s:76,l:53},brown:{r:165,g:42,b:42,h:0,s:59,l:41},burlywood:{r:222,g:184,b:135,h:34,s:57,l:70},
cadetblue:{r:95,g:158,b:160,h:182,s:25,l:50},chartreuse:{r:127,g:255,b:0,h:90,s:100,l:50},chocolate:{r:210,g:105,b:30,h:25,s:75,l:47},coral:{r:255,g:127,b:80,h:16,s:100,l:66},cornflowerblue:{r:100,g:149,b:237,h:219,s:79,l:66},cornsilk:{r:255,g:248,b:220,h:48,s:100,l:93},cyan:{r:0,g:255,b:255,h:180,s:100,l:97},crimson:{r:220,g:20,b:60,h:348,s:83,l:47},darkblue:{r:0,g:0,b:139,h:240,s:100,l:27},darkcyan:{r:0,g:139,b:139,h:180,s:100,l:27},darkgoldenrod:{r:184,g:134,b:11,h:43,s:89,l:38},darkgray:{r:169,
g:169,b:169,h:0,s:0,l:66},darkgreen:{r:0,g:100,b:0,h:120,s:100,l:20},darkgrey:{r:169,g:169,b:169,h:0,s:0,l:66},darkkhaki:{r:189,g:183,b:107,h:56,s:38,l:58},darkmagenta:{r:139,g:0,b:139,h:300,s:100,l:27},darkolivegreen:{r:85,g:107,b:47,h:82,s:39,l:30},darkorange:{r:255,g:140,b:0,h:33,s:100,l:50},darkorchid:{r:153,g:50,b:204,h:280,s:61,l:50},darkred:{r:139,g:0,b:0,h:0,s:100,l:27},darksalmon:{r:233,g:150,b:122,h:15,s:72,l:70},darkseagreen:{r:143,g:188,b:143,h:120,s:25,l:65},darkslateblue:{r:72,g:61,
b:139,h:248,s:39,l:39},darkslategray:{r:47,g:79,b:79,h:180,s:25,l:25},darkslategrey:{r:47,g:79,b:79,h:180,s:25,l:25},darkturquoise:{r:0,g:206,b:209,h:181,s:100,l:41},darkviolet:{r:148,g:0,b:211,h:282,s:100,l:41},deeppink:{r:255,g:20,b:147,h:328,s:100,l:54},deepskyblue:{r:0,g:191,b:255,h:195,s:100,l:50},dimgray:{r:105,g:105,b:105,h:0,s:0,l:41},dimgrey:{r:105,g:105,b:105,h:0,s:0,l:41},dodgerblue:{r:30,g:144,b:255,h:210,s:100,l:56},firebrick:{r:178,g:34,b:34,h:0,s:68,l:42},floralwhite:{r:255,g:250,b:240,
h:40,s:100,l:97},forestgreen:{r:34,g:139,b:34,h:120,s:61,l:34},gainsboro:{r:220,g:220,b:220,h:0,s:0,l:86},ghostwhite:{r:248,g:248,b:255,h:240,s:100,l:99},gold:{r:255,g:215,b:0,h:51,s:100,l:50},goldenrod:{r:218,g:165,b:32,h:43,s:74,l:49},greenyellow:{r:173,g:255,b:47,h:84,s:100,l:59},grey:{r:128,g:128,b:128,h:0,s:0,l:50},honeydew:{r:240,g:255,b:240,h:120,s:100,l:97},hotpink:{r:255,g:105,b:180,h:330,s:100,l:71},indianred:{r:205,g:92,b:92,h:0,s:53,l:58},indigo:{r:75,g:0,b:130,h:275,s:100,l:25},ivory:{r:255,
g:255,b:240,h:60,s:100,l:97},khaki:{r:240,g:230,b:140,h:54,s:77,l:75},lavender:{r:230,g:230,b:250,h:240,s:67,l:94},lavenderblush:{r:255,g:240,b:245,h:340,s:100,l:97},lawngreen:{r:124,g:252,b:0,h:90,s:100,l:49},lemonchiffon:{r:255,g:250,b:205,h:54,s:100,l:90},lightblue:{r:173,g:216,b:230,h:195,s:53,l:79},lightcoral:{r:240,g:128,b:128,h:0,s:79,l:72},lightcyan:{r:224,g:255,b:255,h:180,s:100,l:94},lightgoldenrodyellow:{r:250,g:250,b:210,h:60,s:80,l:90},lightgray:{r:211,g:211,b:211,h:0,s:0,l:83},lightgreen:{r:144,
g:238,b:144,h:120,s:73,l:75},lightgrey:{r:211,g:211,b:211,h:0,s:0,l:83},lightpink:{r:255,g:182,b:193,h:351,s:100,l:86},lightsalmon:{r:255,g:160,b:122,h:17,s:100,l:74},lightseagreen:{r:32,g:178,b:170,h:177,s:70,l:41},lightskyblue:{r:135,g:206,b:250,h:203,s:92,l:75},lightslategray:{r:119,g:136,b:153,h:210,s:14,l:53},lightslategrey:{r:119,g:136,b:153,h:210,s:14,l:53},lightsteelblue:{r:176,g:196,b:222,h:214,s:41,l:78},lightyellow:{r:255,g:255,b:224,h:60,s:100,l:94},limegreen:{r:50,g:205,b:50,h:120,s:61,
l:50},linen:{r:250,g:240,b:230,h:30,s:67,l:94},magenta:{r:255,g:0,b:255,h:17,s:100,l:74},mediumaquamarine:{r:102,g:205,b:170,h:160,s:51,l:60},mediumblue:{r:0,g:0,b:205,h:240,s:100,l:40},mediumorchid:{r:186,g:85,b:211,h:288,s:59,l:58},mediumpurple:{r:147,g:112,b:219,h:260,s:60,l:65},mediumseagreen:{r:60,g:179,b:113,h:147,s:50,l:47},mediumslateblue:{r:123,g:104,b:238,h:249,s:80,l:67},mediumspringgreen:{r:0,g:250,b:154,h:157,s:100,l:49},mediumturquoise:{r:72,g:209,b:204,h:178,s:60,l:55},mediumvioletred:{r:199,
g:21,b:133,h:322,s:81,l:43},midnightblue:{r:25,g:25,b:112,h:240,s:64,l:27},mintcream:{r:245,g:255,b:250,h:150,s:100,l:98},mistyrose:{r:255,g:228,b:225,h:6,s:100,l:94},moccasin:{r:255,g:228,b:181,h:38,s:100,l:85},navajowhite:{r:255,g:222,b:173,h:36,s:100,l:84},oldlace:{r:253,g:245,b:230,h:39,s:85,l:95},olivedrab:{r:107,g:142,b:35,h:80,s:60,l:35},orangered:{r:255,g:69,b:0,h:16,s:100,l:50},orchid:{r:218,g:112,b:214,h:302,s:59,l:65},palegoldenrod:{r:238,g:232,b:170,h:55,s:67,l:80},palegreen:{r:152,g:251,
b:152,h:120,s:93,l:79},paleturquoise:{r:175,g:238,b:238,h:180,s:65,l:81},palevioletred:{r:219,g:112,b:147,h:340,s:60,l:65},papayawhip:{r:255,g:239,b:213,h:37,s:100,l:92},peachpuff:{r:255,g:218,b:185,h:28,s:100,l:86},peru:{r:205,g:133,b:63,h:30,s:59,l:53},pink:{r:255,g:192,b:203,h:350,s:100,l:88},plum:{r:221,g:160,b:221,h:300,s:47,l:75},powderblue:{r:176,g:224,b:230,h:187,s:52,l:80},rosybrown:{r:188,g:143,b:143,h:0,s:25,l:65},royalblue:{r:65,g:105,b:225,h:225,s:73,l:57},saddlebrown:{r:139,g:69,b:19,
h:25,s:76,l:31},salmon:{r:250,g:128,b:114,h:6,s:93,l:71},sandybrown:{r:244,g:164,b:96,h:28,s:87,l:67},seagreen:{r:46,g:139,b:87,h:146,s:50,l:36},seashell:{r:255,g:245,b:238,h:25,s:100,l:97},sienna:{r:160,g:82,b:45,h:19,s:56,l:40},skyblue:{r:135,g:206,b:235,h:197,s:71,l:73},slateblue:{r:106,g:90,b:205,h:248,s:53,l:58},slategray:{r:112,g:128,b:144,h:210,s:13,l:50},slategrey:{r:112,g:128,b:144,h:210,s:13,l:50},snow:{r:255,g:250,b:250,h:0,s:100,l:99},springgreen:{r:0,g:255,b:127,h:150,s:100,l:50},steelblue:{r:70,
g:130,b:180,h:207,s:44,l:49},tan:{r:210,g:180,b:140,h:34,s:44,l:69},thistle:{r:216,g:191,b:216,h:300,s:24,l:80},tomato:{r:255,g:99,b:71,h:9,s:100,l:64},turquoise:{r:64,g:224,b:208,h:174,s:72,l:56},violet:{r:238,g:130,b:238,h:300,s:76,l:72},wheat:{r:245,g:222,b:179,h:39,s:77,l:83},whitesmoke:{r:245,g:245,b:245,h:0,s:0,l:96},yellowgreen:{r:154,g:205,b:50,h:80,s:61,l:50}};f.exports=c},{}]},{},[1])(1)})}).call(this,"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],2:[function(f,
q,r){(function(e){!function(f){if("object"==typeof r)q.exports=f();else{var l;"undefined"!=typeof window?l=window:"undefined"!=typeof e?l=e:"undefined"!=typeof self&&(l=self);l.linearalgea=f()}}(function(){return function l(e,h,c){function k(a,m){if(!h[a]){if(!e[a]){var b="function"==typeof f&&f;if(!m&&b)return b(a,!0);if(g)return g(a,!0);throw Error("Cannot find module '"+a+"'");}b=h[a]={exports:{}};e[a][0].call(b.exports,function(b){var c=e[a][1][b];return k(c?c:b)},b,b.exports,l,e,h,c)}return h[a].exports}
for(var g="function"==typeof f&&f,a=0;a<c.length;a++)k(c[a]);return k}({1:[function(e,f,h){h=e("./vector.js");e=e("./matrix.js");var c=Object.create(null);c.Vector=h;c.Matrix=e;f.exports=c},{"./matrix.js":2,"./vector.js":3}],2:[function(e,f,h){function c(){for(var b=0;16>b;b++)this[b]=0;this.length=16}e=e("./vector.js");c.prototype.equal=function(b){for(var n=0,a=this.length;n<a;n++)if(this[n]!==b[n])return!1;return!0};c.prototype.add=function(b){for(var a=new c,d=0,g=this.length;d<g;d++)a[d]=this[d]+
b[d];return a};c.prototype.addLG=function(b,a){a[0]=this[0]+b[0];a[1]=this[1]+b[1];a[2]=this[2]+b[2];a[3]=this[3]+b[3];a[4]=this[4]+b[4];a[5]=this[5]+b[5];a[6]=this[6]+b[6];a[7]=this[7]+b[7];a[8]=this[8]+b[8];a[9]=this[9]+b[9];a[10]=this[10]+b[10];a[11]=this[11]+b[11];a[12]=this[12]+b[12];a[13]=this[13]+b[13];a[14]=this[14]+b[14];a[15]=this[15]+b[15]};c.prototype.subtract=function(b){for(var a=new c,d=0,g=this.length;d<g;d++)a[d]=this[d]-b[d];return a};c.prototype.subtractLG=function(b,a){a[0]=this[0]-
b[0];a[1]=this[1]-b[1];a[2]=this[2]-b[2];a[3]=this[3]-b[3];a[4]=this[4]-b[4];a[5]=this[5]-b[5];a[6]=this[6]-b[6];a[7]=this[7]-b[7];a[8]=this[8]-b[8];a[9]=this[9]-b[9];a[10]=this[10]-b[10];a[11]=this[11]-b[11];a[12]=this[12]-b[12];a[13]=this[13]-b[13];a[14]=this[14]-b[14];a[15]=this[15]-b[15]};c.prototype.multiplyScalar=function(b){for(var a=new c,d=0,g=this.length;d<g;d++)a[d]=this[d]*b;return a};c.prototype.multiplyScalarLG=function(b,a){a[0]=this[0]*b;a[1]=this[1]*b;a[2]=this[2]*b;a[3]=this[3]*
b;a[4]=this[4]*b;a[5]=this[5]*b;a[6]=this[6]*b;a[7]=this[7]*b;a[8]=this[8]*b;a[9]=this[9]*b;a[10]=this[10]*b;a[11]=this[11]*b;a[12]=this[12]*b;a[13]=this[13]*b;a[14]=this[14]*b;a[15]=this[15]*b};c.prototype.multiply=function(b){var a=new c;a[0]=this[0]*b[0]+this[1]*b[4]+this[2]*b[8]+this[3]*b[12];a[1]=this[0]*b[1]+this[1]*b[5]+this[2]*b[9]+this[3]*b[13];a[2]=this[0]*b[2]+this[1]*b[6]+this[2]*b[10]+this[3]*b[14];a[3]=this[0]*b[3]+this[1]*b[7]+this[2]*b[11]+this[3]*b[15];a[4]=this[4]*b[0]+this[5]*b[4]+
this[6]*b[8]+this[7]*b[12];a[5]=this[4]*b[1]+this[5]*b[5]+this[6]*b[9]+this[7]*b[13];a[6]=this[4]*b[2]+this[5]*b[6]+this[6]*b[10]+this[7]*b[14];a[7]=this[4]*b[3]+this[5]*b[7]+this[6]*b[11]+this[7]*b[15];a[8]=this[8]*b[0]+this[9]*b[4]+this[10]*b[8]+this[11]*b[12];a[9]=this[8]*b[1]+this[9]*b[5]+this[10]*b[9]+this[11]*b[13];a[10]=this[8]*b[2]+this[9]*b[6]+this[10]*b[10]+this[11]*b[14];a[11]=this[8]*b[3]+this[9]*b[7]+this[10]*b[11]+this[11]*b[15];a[12]=this[12]*b[0]+this[13]*b[4]+this[14]*b[8]+this[15]*
b[12];a[13]=this[12]*b[1]+this[13]*b[5]+this[14]*b[9]+this[15]*b[13];a[14]=this[12]*b[2]+this[13]*b[6]+this[14]*b[10]+this[15]*b[14];a[15]=this[12]*b[3]+this[13]*b[7]+this[14]*b[11]+this[15]*b[15];return a};c.prototype.multiplyLG=function(b,a){a[0]=this[0]*b[0]+this[1]*b[4]+this[2]*b[8]+this[3]*b[12];a[1]=this[0]*b[1]+this[1]*b[5]+this[2]*b[9]+this[3]*b[13];a[2]=this[0]*b[2]+this[1]*b[6]+this[2]*b[10]+this[3]*b[14];a[3]=this[0]*b[3]+this[1]*b[7]+this[2]*b[11]+this[3]*b[15];a[4]=this[4]*b[0]+this[5]*
b[4]+this[6]*b[8]+this[7]*b[12];a[5]=this[4]*b[1]+this[5]*b[5]+this[6]*b[9]+this[7]*b[13];a[6]=this[4]*b[2]+this[5]*b[6]+this[6]*b[10]+this[7]*b[14];a[7]=this[4]*b[3]+this[5]*b[7]+this[6]*b[11]+this[7]*b[15];a[8]=this[8]*b[0]+this[9]*b[4]+this[10]*b[8]+this[11]*b[12];a[9]=this[8]*b[1]+this[9]*b[5]+this[10]*b[9]+this[11]*b[13];a[10]=this[8]*b[2]+this[9]*b[6]+this[10]*b[10]+this[11]*b[14];a[11]=this[8]*b[3]+this[9]*b[7]+this[10]*b[11]+this[11]*b[15];a[12]=this[12]*b[0]+this[13]*b[4]+this[14]*b[8]+this[15]*
b[12];a[13]=this[12]*b[1]+this[13]*b[5]+this[14]*b[9]+this[15]*b[13];a[14]=this[12]*b[2]+this[13]*b[6]+this[14]*b[10]+this[15]*b[14];a[15]=this[12]*b[3]+this[13]*b[7]+this[14]*b[11]+this[15]*b[15]};c.prototype.negate=function(){for(var b=new c,a=0,d=this.length;a<d;a++)b[a]=-this[a];return b};c.prototype.negateLG=function(b){b[0]=-this[0];b[1]=-this[1];b[2]=-this[2];b[3]=-this[3];b[4]=-this[4];b[5]=-this[5];b[6]=-this[6];b[7]=-this[7];b[8]=-this[8];b[9]=-this[9];b[10]=-this[10];b[11]=-this[11];b[12]=
-this[12];b[13]=-this[13];b[14]=-this[14];b[15]=-this[15]};c.prototype.transpose=function(){var b=new c;b[0]=this[0];b[1]=this[4];b[2]=this[8];b[3]=this[12];b[4]=this[1];b[5]=this[5];b[6]=this[9];b[7]=this[13];b[8]=this[2];b[9]=this[6];b[10]=this[10];b[11]=this[14];b[12]=this[3];b[13]=this[7];b[14]=this[11];b[15]=this[15];return b};c.prototype.transposeLG=function(b){b[0]=this[0];b[1]=this[4];b[2]=this[8];b[3]=this[12];b[4]=this[1];b[5]=this[5];b[6]=this[9];b[7]=this[13];b[8]=this[2];b[9]=this[6];
b[10]=this[10];b[11]=this[14];b[12]=this[3];b[13]=this[7];b[14]=this[11];b[15]=this[15]};c.prototype.empty=function(){for(var b=0,a=this.length;b<a;b++)this[b]=0};c.prototype.copy=function(b){for(var a=0;16>a;a++)b[a]=this[a]};c.rotationX=function(b){var a=new c,d=Math.cos(b);b=Math.sin(b);a[0]=1;a[5]=d;a[6]=-b;a[9]=b;a[10]=d;a[15]=1;return a};c.rotationXLG=function(b,a){var c=Math.cos(b),d=Math.sin(b);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=c;a[6]=-d;a[7]=0;a[8]=0;a[9]=d;a[10]=c;a[11]=0;a[12]=0;
a[13]=0;a[14]=0;a[15]=1};c.rotationY=function(b){var a=new c,d=Math.cos(b);b=Math.sin(b);a[0]=d;a[2]=b;a[5]=1;a[8]=-b;a[10]=d;a[15]=1;return a};c.rotationYLG=function(b,a){var c=Math.cos(b),d=Math.sin(b);a[0]=c;a[1]=0;a[2]=d;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=-d;a[9]=0;a[10]=c;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1};c.rotationZ=function(b){var a=new c,d=Math.cos(b);b=Math.sin(b);a[0]=d;a[1]=-b;a[4]=b;a[5]=d;a[10]=1;a[15]=1;return a};c.rotationZLG=function(b,a){var c=Math.cos(b),d=Math.sin(b);
a[0]=c;a[1]=-d;a[2]=0;a[3]=0;a[4]=d;a[5]=c;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1};c.rotationAxis=function(b,a){var d=new c,g=b.normalize(),m=Math.sin(a),e=Math.cos(a),h=1-e,k=g.x,f=g.y,g=g.z,l=k*f,p=k*g,q=f*g;d[0]=e+k*k*h;d[1]=l*h-g*m;d[2]=p*h+f*m;d[4]=l*h+g*m;d[5]=e+f*f*h;d[6]=q*h-k*m;d[8]=p*h-f*m;d[9]=q*h+k*m;d[10]=e+g*g*h;d[15]=1;return d};c.rotationAxisLG=function(b,a,c){b.normalizeLG(m);b=Math.sin(a);a=Math.cos(a);var d=1-a,g=m.x,e=m.y,h=m.z,k=g*e,f=g*h,
l=e*h;c[0]=a+g*g*d;c[1]=k*d-h*b;c[2]=f*d+e*b;c[3]=0;c[4]=k*d+h*b;c[5]=a+e*e*d;c[6]=l*d-g*b;c[7]=0;c[8]=f*d-e*b;c[9]=l*d+g*b;c[10]=a+h*h*d;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1};c.rotation=function(b,a,d){return c.rotationX(d).multiply(c.rotationZ(a)).multiply(c.rotationY(b))};c.rotationLG=function(b,m,e,h){c.rotationXLG(e,k);c.rotationZLG(m,g);c.rotationYLG(b,a);k.multiplyLG(g,d);d.multiplyLG(a,h)};c.translation=function(b,a,d){var g=c.identity();g[12]=b;g[13]=a;g[14]=d;return g};c.translationLG=
function(b,a,c,d){d[0]=1;d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=1;d[6]=0;d[7]=0;d[8]=0;d[9]=0;d[10]=1;d[12]=b;d[13]=a;d[14]=c;d[15]=1};c.scale=function(b,a,d){var g=new c;g[0]=b;g[5]=a;g[10]=d;g[15]=1;return g};c.scaleLG=function(b,a,c,d){d[0]=b;d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=a;d[6]=0;d[7]=0;d[8]=0;d[9]=0;d[10]=c;d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1};c.identity=function(){var b=new c;b[0]=1;b[5]=1;b[10]=1;b[15]=1;return b};c.identityLG=function(b){b[0]=1;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=1;b[6]=0;b[7]=
0;b[8]=0;b[9]=0;b[10]=1;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1};c.zero=function(){return new c};c.zeroLG=function(b){b[0]=0;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=0;b[6]=0;b[7]=0;b[8]=0;b[9]=0;b[10]=0;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=0};c.fromArray=function(b){for(var a=new c,d=0;16>d;d++)a[d]=b[d];return a};c.fromArrayLG=function(a,d){d[0]=a[0];d[1]=a[1];d[2]=a[2];d[3]=a[3];d[4]=a[4];d[5]=a[5];d[6]=a[6];d[7]=a[7];d[8]=a[8];d[9]=a[9];d[10]=a[10];d[11]=a[11];d[12]=a[12];d[13]=a[13];d[14]=a[14];d[15]=
a[15]};c.copy=function(a,d){for(var c=0;16>c;c++)d[c]=a[c]};var k=new c,g=new c,a=new c,d=new c,m=new e(0,0,0);f.exports=c},{"./vector.js":3}],3:[function(e,f,h){function c(a,d,c){if("undefined"===typeof a||"undefined"===typeof d||"undefined"===typeof c)throw Error("Insufficient arguments.");this.x=a;this.y=d;this.z=c}c.prototype.add=function(a){return new c(this.x+a.x,this.y+a.y,this.z+a.z)};c.prototype.addLG=function(a,d){d.x=this.x+a.x;d.y=this.y+a.y;d.z=this.z+a.z};c.prototype.subtract=function(a){return new c(this.x-
a.x,this.y-a.y,this.z-a.z)};c.prototype.subtractLG=function(a,d){d.x=this.x-a.x;d.y=this.y-a.y;d.z=this.z-a.z};c.prototype.equal=function(a){return this.x===a.x&&this.y===a.y&&this.z===a.z};c.prototype.angle=function(a){var d=this.normalize();a=a.normalize();var c=d.magnitude(),b=a.magnitude();if(0===c||0===b)return 0;d=d.dot(a)/(c*b);-1>d&&(d=-1);1<d&&(d=1);return Math.acos(d)};c.prototype.angleLG=function(a){this.normalizeLG(k);a.normalizeLG(g);a=k.magnitude();var d=g.magnitude();if(0===a||0===
d)return 0;a=k.dot(g)/(a*d);-1>a&&(a=-1);1<a&&(a=1);return Math.acos(a)};c.prototype.cosAngle=function(a){var d=this.normalize();a=a.normalize();var c=d.magnitude(),b=a.magnitude();if(0===c||0===b)return 0;d=d.dot(a)/(c*b);-1>d&&(d=-1);1<d&&(d=1);return d};c.prototype.cosAngleLG=function(a){this.normalizeLG(k);a.normalizeLG(g);a=k.magnitude();var d=g.magnitude();if(0===a||0===d)return 0;a=k.dot(g)/(a*d);-1>a&&(a=-1);1<a&&(a=1);return a};c.prototype.magnitude=function(){return Math.sqrt(this.x*this.x+
this.y*this.y+this.z*this.z)};c.prototype.magnitudeSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z};c.prototype.dot=function(a){return this.x*a.x+this.y*a.y+this.z*a.z};c.prototype.cross=function(a){return new c(this.y*a.z-this.z*a.y,this.z*a.x-this.x*a.z,this.x*a.y-this.y*a.x)};c.prototype.crossLG=function(a,d){d.x=this.y*a.z-this.z*a.y;d.y=this.z*a.x-this.x*a.z;d.z=this.x*a.y-this.y*a.x};c.prototype.normalize=function(){var a=this.magnitude();return 0===a?new c(this.x,this.y,
this.z):new c(this.x/a,this.y/a,this.z/a)};c.prototype.normalizeLG=function(a){var d=this.magnitude();0===d&&(a.x=this.x,a.y=this.y,a.z=this.z);a.x=this.x/d;a.y=this.y/d;a.z=this.z/d};c.prototype.scale=function(a){return new c(this.x*a,this.y*a,this.z*a)};c.prototype.scaleLG=function(a,d){d.x=this.x*a;d.y=this.y*a;d.z=this.z*a};c.prototype.negate=function(){return new c(-this.x,-this.y,-this.z)};c.prototype.negateLG=function(a){a.x=-this.x;a.y=-this.y;a.z=-this.z};c.prototype.vectorProjection=function(a){var d=
a.magnitude();return a.scale(this.dot(a)/(d*d))};c.prototype.vectorProjectionLG=function(a,d){var c=a.magnitude();a.scaleLG(this.dot(a)/(c*c),d)};c.prototype.scalarProjection=function(a){return this.dot(a)/a.magnitude()};c.prototype.transform=function(a){var d=this.x*a[3]+this.y*a[7]+this.z*a[11]+a[15];return new c((this.x*a[0]+this.y*a[4]+this.z*a[8]+a[12])/d,(this.x*a[1]+this.y*a[5]+this.z*a[9]+a[13])/d,(this.x*a[2]+this.y*a[6]+this.z*a[10]+a[14])/d)};c.prototype.transformLG=function(a,d){var c=
this.x*a[1]+this.y*a[5]+this.z*a[9]+a[13],b=this.x*a[2]+this.y*a[6]+this.z*a[10]+a[14],g=this.x*a[3]+this.y*a[7]+this.z*a[11]+a[15];d.x=(this.x*a[0]+this.y*a[4]+this.z*a[8]+a[12])/g;d.y=c/g;d.z=b/g};c.prototype.rotate=function(a,d){var g=a.normalize(),b=Math.sin(d),e=Math.cos(d),h=1-e,k=g.x,f=g.y,l=g.z,p=g.x*g.y,q=g.x*g.z,g=g.y*g.z;return new c((e+k*k*h)*this.x+(p*h-l*b)*this.y+(q*h+f*b)*this.z,(p*h+l*b)*this.x+(e+f*f*h)*this.y+(g*h-k*b)*this.z,(q*h-f*b)*this.x+(g*h+k*b)*this.y+(e+k*k*h)*this.z)};
c.prototype.rotateLG=function(a,d,c){a.normalizeLG(c);a=Math.sin(d);d=Math.cos(d);var b=1-d,g=c.x,e=c.y,h=c.z,k=c.x*c.y,f=c.x*c.z,l=c.y*c.z,p=(k*b+h*a)*this.x+(d+e*e*b)*this.y+(l*b-g*a)*this.z,l=(f*b-e*a)*this.x+(l*b+g*a)*this.y+(d+g*g*b)*this.z;c.x=(d+g*g*b)*this.x+(k*b-h*a)*this.y+(f*b+e*a)*this.z;c.y=p;c.z=l};c.prototype.rotateX=function(a){var d=Math.sin(a);a=Math.cos(a);return new c(this.x,a*this.y-d*this.z,d*this.y+a*this.z)};c.prototype.rotateXLG=function(a,c){var g=Math.sin(a),b=Math.cos(a),
e=b*this.y-g*this.z,g=g*this.y+b*this.z;c.x=this.x;c.y=e;c.z=g};c.prototype.rotateY=function(a){var d=Math.sin(a);a=Math.cos(a);return new c(a*this.x+d*this.z,this.y,-(d*this.x)+a*this.z)};c.prototype.rotateYLG=function(a,c){var g=Math.sin(a),b=Math.cos(a),e=this.y,h=-(g*this.x)+b*this.z;c.x=b*this.x+g*this.z;c.y=e;c.z=h};c.prototype.rotateZ=function(a){var d=Math.sin(a);a=Math.cos(a);return new c(a*this.x-d*this.y,d*this.x+a*this.y,this.z)};c.prototype.rotateZLG=function(a,c){var g=Math.sin(a),b=
Math.cos(a),e=g*this.x+b*this.y,h=this.z;c.x=b*this.x-g*this.y;c.y=e;c.z=h};c.prototype.rotatePitchYawRoll=function(a,c,g){return this.rotateX(g).rotateY(a).rotateZ(c)};c.prototype.rotatePitchYawRollLG=function(a,c,g,b){this.rotateXLG(g,b);b.rotateYLG(a,b);b.rotateZLG(c,b)};var k=new c(0,0,0),g=new c(0,0,0);f.exports=c},{}]},{},[1])(1)})}).call(this,"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],3:[function(f,q,r){function e(e,c,k){this.position=k||new s(1,1,20);this.up=
new s(0,1,0);this.rotation={yaw:0,pitch:0,roll:0};this.view_matrix=new l;this.width=e;this.height=c;this.near=.1;this.far=1E3;this.fov=90;this.perspectiveFov=new l;this._xaxis=new s(0,0,0);this._yaxis=new s(0,0,0);this._zaxis=new s(0,0,0);this._direction=new s(0,0,0);this._temp_vector1=new s(0,0,0);this._temp_vector2=new s(0,0,0);this._temp_matrix=new l;this.calculatePerspectiveFov();this.createViewMatrix()}f=f("linearalgea");var s=f.Vector,l=f.Matrix,p=2*Math.PI;e.prototype.direction=function(){var e=
Math.sin(this.rotation.pitch),c=Math.cos(this.rotation.pitch),k=Math.sin(this.rotation.yaw),g=Math.cos(this.rotation.yaw);this._direction.x=-c*k;this._direction.y=e;this._direction.z=-c*g};e.prototype.calculatePerspectiveFov=function(){var e=this.width/this.height,c=this.near,k=this.far,g=1/Math.tan(Math.PI/180*this.fov/2)*this.height;this.perspectiveFov[0]=g*e;this.perspectiveFov[5]=g;this.perspectiveFov[10]=k/(c-k);this.perspectiveFov[11]=-1;this.perspectiveFov[14]=c*k/(c-k)};e.prototype.createViewMatrix=
function(){var e=this.position,c=this.rotation.pitch,k=this.rotation.yaw,g=Math.cos(c),c=Math.sin(c),a=Math.cos(k),k=Math.sin(k);this._xaxis.x=a;this._xaxis.y=0;this._xaxis.z=-k;this._yaxis.x=k*c;this._yaxis.y=g;this._yaxis.z=a*c;this._zaxis.x=k*g;this._zaxis.y=-c;this._zaxis.z=g*a;l.fromArrayLG([this._xaxis.x,this._yaxis.x,this._zaxis.x,0,this._xaxis.y,this._yaxis.y,this._zaxis.y,0,this._xaxis.z,this._yaxis.z,this._zaxis.z,0,-this._xaxis.dot(e),-this._yaxis.dot(e),-this._zaxis.dot(e),1],this.view_matrix)};
e.prototype.look=function(e,c){this.rotation.yaw-=e;0>this.rotation.yaw?this.rotation.yaw+=p:this.rotation.yaw>p&&(this.rotation.yaw-=p);this.rotation.pitch-=c;0>this.rotation.pitch?this.rotation.pitch+=p:this.rotation.pitch>p&&(this.rotation.pitch-=p);this.createViewMatrix()};e.prototype.turnRight=function(e){this.rotation.yaw-=e;0>this.rotation.yaw&&(this.rotation.yaw+=p);this.createViewMatrix()};e.prototype.turnLeft=function(e){this.rotation.yaw+=e;this.rotation.yaw>p&&(this.rotation.yaw-=p);this.createViewMatrix()};
e.prototype.lookUp=function(e){this.rotation.pitch-=e;this.rotation.pitch>p&&(this.rotation.pitch-=p);this.createViewMatrix()};e.prototype.lookDown=function(e){this.rotation.pitch+=e;0>this.rotation.pitch&&(this.rotation.pitch+=p);this.createViewMatrix()};e.prototype.moveTo=function(e,c,k){this.position.x=e;this.position.y=c;this.position.z=k;this.createViewMatrix()};e.prototype.move=function(e,c,k){this.position.x+=e;this.position.y+=c;this.position.z+=k;this.createViewMatrix()};e.prototype.moveRight=
function(e){this.direction();this._direction.normalizeLG(this._temp_vector1);this._temp_vector1.scaleLG(e,this._temp_vector2);this.up.crossLG(this._temp_vector2,this._temp_vector1);this.position.subtractLG(this._temp_vector1,this.position);this.createViewMatrix()};e.prototype.moveLeft=function(e){this.direction();this._direction.normalizeLG(this._temp_vector1);this._temp_vector1.scaleLG(e,this._temp_vector2);this.up.crossLG(this._temp_vector2,this._temp_vector1);this.position.addLG(this._temp_vector1,
this.position);this.createViewMatrix()};e.prototype.moveUp=function(e){this.up.normalizeLG(this._temp_vector1);this._temp_vector1.scaleLG(e,this._temp_vector2);this.position.subtractLG(this._temp_vector2,this.position);this.createViewMatrix()};e.prototype.moveDown=function(e){this.up.normalizeLG(this._temp_vector1);this._temp_vector1.scaleLG(e,this._temp_vector2);this.position.addLG(this._temp_vector2,this.position);this.createViewMatrix()};e.prototype.moveForward=function(e){this.direction();this._direction.normalizeLG(this._temp_vector1);
this._temp_vector1.scaleLG(e,this._temp_vector2);this.position.addLG(this._temp_vector2,this.position);this.createViewMatrix()};e.prototype.moveBackward=function(e){this.direction();this._direction.normalizeLG(this._temp_vector1);this._temp_vector1.scaleLG(e,this._temp_vector2);this.position.subtractLG(this._temp_vector2,this.position);this.createViewMatrix()};q.exports=e},{linearalgea:2}],4:[function(f,q,r){r=f("./scene.js");f=f("./camera.js");q.exports.Scene=r;q.exports.Camera=f},{"./camera.js":3,
"./scene.js":6}],5:[function(f,q,r){q.exports={_listeners:{},addListener:function(e,f){e in this._listeners||(this._listeners[e]=[]);this._listeners[e].push(f)},fire:function(e,f){var l={};"undefined"!==typeof f&&(l=f);l.event=e;l.target=this;var p=this._listeners[e];if("undefined"!==typeof p)for(var h=0,c=p.length;h<c;h++)p[h].call(this,l)},removeListener:function(e,f){for(var l=this._listeners[e],p=0,h=l.length;p<h;p++)l[p]===f&&l.splice(p,1)}}},{}],6:[function(f,q,r){function e(g){this.width=g.width;
this.height=g.height;this.canvas=document.getElementById(g.canvas_id);this.ctx=this.canvas.getContext("2d");this.camera=new s(this.width,this.height);this.illumination=new c(90,0,0);this.meshes={};this._x_offset=Math.round(this.width/2);this._y_offset=Math.round(this.height/2);this._back_buffer=document.createElement("canvas");this._back_buffer.width=this.width;this._back_buffer.height=this.height;this._back_buffer_ctx=this._back_buffer.getContext("2d");this._back_buffer_image=null;this._depth_buffer=
[];this._backface_culling=!0;this._keys={};this._key_count=0;this._anim_id=null;this._needs_update=!0;this._draw_mode=0;this.canvas.tabIndex=1;this._back_buffer_image=this._back_buffer_ctx.createImageData(this.width,this.height);this.canvas.addEventListener("keydown",this.onKeyDown.bind(this),!1);this.canvas.addEventListener("keyup",this.onKeyUp.bind(this),!1);this.canvas.addEventListener("blur",this.emptyKeys.bind(this),!1);this.canvas.addEventListener("mousedown",this.onMouseDown.bind(this),!1);
this.canvas.addEventListener("mouseup",this.onMouseUp.bind(this),!1);this.canvas.addEventListener("mousemove",this.onMouseMove.bind(this),!1);this.initializeDepthBuffer();this.update();this._light_direction=new c(0,0,0);this._wv1=new k;this._wv2=new k;this._wv3=new k;this._v1=new c(0,0,0);this._v2=new c(0,0,0);this._v3=new c(0,0,0);this._v1t=new c(0,0,0);this._v2t=new c(0,0,0);this._v3t=new c(0,0,0);this._wvp_matrix=new k;this._world_matrix=new k;this._rotation_matrix=new k;this._translation_matrix=
new k;this._scale_matrix=new k;this._cam_to_vert=new c(0,0,0);this._temp_matrix=new k;this._side1=new c(0,0,0);this._side2=new c(0,0,0);this._norm=new c(0,0,0)}r=f("linearalgea");var s=f("./camera.js"),l=f("./events.js"),p=f("../utilities/mixin.js"),h=f("../utilities/keycodes.js"),c=r.Vector,k=r.Matrix;p(e.prototype,l);e.prototype.emptyKeys=function(){this._key_count=0;this._keys={}};e.prototype.isKeyDown=function(c){c=h[c];return c in this._keys&&this._keys[c]};e.prototype.onKeyDown=function(c){c=
c.keyCode||c.which;this.isKeyDown(c)||(this._key_count+=1,this._keys[c]=!0)};e.prototype.onKeyUp=function(c){c=c.keyCode||c.which;c in this._keys&&(this._key_count-=1,this._keys[c]=!1)};e.prototype._getMousePos=function(c){var a=this.canvas.getBoundingClientRect();return{x:c.clientX-a.left,y:c.clientY-a.top}};e.prototype.onMouseDown=function(c){this._last_mouse_update=this._last_mouse_coords=void 0;c={mouse:this._getMousePos(c)};this.fire("mousedown",c);var a=this.onMouseDrag.bind(this),d=function(){this.removeEventListener("mousemove",
a,!1);this.removeEventListener("mouseup",d,!1);this._last_mouse_update=this._last_mouse_coords=void 0};this.canvas.addEventListener("mousemove",a,!1);this.canvas.addEventListener("mouseup",d,!1);this.canvas.addEventListener("mouseleave",d,!1)};e.prototype.onMouseUp=function(c){c={mouse:this._getMousePos(c)};this.fire("mouseup",c)};e.prototype.onMouseMove=function(c){c={mouse:this._getMousePos(c)};this.fire("mousemove",c)};e.prototype.onMouseDrag=function(c){c=this._getMousePos(c);"undefined"===typeof this._last_mouse_coords&&
(this._last_mouse_coords=c);"undefined"===typeof this._last_mouse_update&&(this._last_mouse_update=new Date);var a=new Date-this._last_mouse_update,d=c.x-this._last_mouse_coords.x,e=c.y-this._last_mouse_coords.y,b=0,f=0;0<a&&(b=d/a,f=e/a);d={mouse:{x:c.x,y:c.y,xvel:b,yvel:f,deltax:d,deltay:e}};this._last_mouse_coords=c;this._last_mouse_update=a;this.fire("mousedrag",d)};e.prototype.initializeDepthBuffer=function(){for(var c=0,a=this.width*this.height;c<a;c++)this._depth_buffer[c]=9999999};e.prototype._clear_back_buffer_image=
function(){for(var c=this._back_buffer_image.data,a=3;a<c.length;a+=4)c[a]=0};e.prototype.offscreen=function(c){var a=c.x+this._x_offset,d=c.y+this._y_offset;return 1<c.z||0>a||a>this.width||0>d||d>this.height};e.prototype.toggleDrawMode=function(){this._draw_mode=(this._draw_mode+1)%2;this.renderScene()};e.prototype.toggleBackfaceCulling=function(){this._backface_culling=!this._backface_culling;this.renderScene()};e.prototype.drawPixel=function(c,a,d,e){c+=this._x_offset;a+=this._y_offset;if(0<=
c&&c<this.width&&0<=a&&a<this.height&&(c+=a*this.width,d<this._depth_buffer[c])){a=this._back_buffer_image.data;var b=4*c;a[b]=e.r;a[b+1]=e.g;a[b+2]=e.b;a[b+3]=255;this._depth_buffer[c]=d}};e.prototype.drawEdge=function(c,a,d){var e=Math.abs;if(c.x>=a.x){var b=c;c=a;a=b}var b=c.x,f=c.y,k=c.z,e=Math.max(e(a.x-c.x),e(a.y-c.y),e(a.z-c.z)),h=(a.x-c.x)/e,l=(a.y-c.y)/e;c=(a.z-c.z)/e;for(a=0;a<e;a++)this.drawPixel(Math.floor(b),Math.floor(f),k,d),b+=h,f+=l,k+=c};e.prototype.drawTriangle=function(c,a,d,e){this.drawEdge(c,
a,e);this.drawEdge(a,d,e);this.drawEdge(d,c,e)};e.prototype.fillTriangle=function(c,a,d,e){var b=c.x,f=a.x,k=d.x,h=c.y,l=a.y,p=d.y;c=c.z;a=a.z;d=d.z;var q=0-this._x_offset,r=this.width-this._x_offset,s=0-this._y_offset,u=this.height-this._y_offset,v=Math.floor(Math.min(b,f,k));v<q&&(v=q);q=Math.ceil(Math.max(b,f,k));q>r&&(q=r);r=Math.floor(Math.min(h,l,p));r<s&&(r=s);s=Math.ceil(Math.max(h,l,p));s>u&&(s=u);for(var A=p-h,y=b-k,w=h-l,u=f-b,x=k*h-b*p,b=b*l-f*h,f=A*f+y*l+x,h=w*k+u*p+b,k=A/f,p=y/f,f=x/
f,l=w/h,u=u/h,b=b/h;v<=q;v++)for(h=r;h<=s;h++)w=k*v+p*h+f,0<=w&&1>=w&&(x=l*v+u*h+b,0<=x&&1>=x&&(y=1-w-x,0<=y&&1>=y&&this.drawPixel(v,h,y*c+w*a+x*d,e)))};e.prototype.renderScene=function(){this._clear_back_buffer_image();this.initializeDepthBuffer();var c=this.camera.view_matrix,a=this.camera.perspectiveFov,d=this.illumination,e;for(e in this.meshes)if(this.meshes.hasOwnProperty(e)){var b=this.meshes[e],f=b.scale,h=b.rotation,l=b.position;k.scaleLG(f.x,f.y,f.z,this._scale_matrix);k.rotationLG(h.pitch,
h.yaw,h.roll,this._rotation_matrix);k.translationLG(l.x,l.y,l.z,this._translation_matrix);this._scale_matrix.multiplyLG(this._rotation_matrix,this._world_matrix);this._world_matrix.multiplyLG(this._translation_matrix,this._world_matrix);for(f=0;f<b.faces.length;f++){var p=b.faces[f].face,h=b.faces[f].color,l=b.vertices[p[0]],q=b.vertices[p[1]],p=b.vertices[p[2]];l.transformLG(this._world_matrix,this._v1t);q.transformLG(this._world_matrix,this._v2t);p.transformLG(this._world_matrix,this._v3t);this.camera.position.subtractLG(this._v1t,
this._cam_to_vert);this._v2t.subtractLG(this._v1t,this._side1);this._v3t.subtractLG(this._v1t,this._side2);this._side1.crossLG(this._side2,this._norm);1E-8<=this._norm.magnitude()&&this._norm.normalizeLG(this._norm);if(!this._backface_culling||0<=this._cam_to_vert.dot(this._norm))this._world_matrix.multiplyLG(c,this._temp_matrix),this._temp_matrix.multiplyLG(a,this._wvp_matrix),l.transformLG(this._wvp_matrix,this._wv1),q.transformLG(this._wvp_matrix,this._wv2),p.transformLG(this._wvp_matrix,this._wv3),
l=!0,this.offscreen(this._wv1)&&this.offscreen(this._wv2)&&this.offscreen(this._wv3)&&(l=!1),l&&(0===this._draw_mode?this.drawTriangle(this._wv1,this._wv2,this._wv3,h.rgb):1===this._draw_mode&&(d.subtractLG(this._v1t,this._light_direction),this._light_direction.normalizeLG(this._light_direction),l=this._norm.dot(this._light_direction),h=h.lighten(15*l),this.fillTriangle(this._wv1,this._wv2,this._wv3,h.rgb)))}}this._back_buffer_ctx.putImageData(this._back_buffer_image,0,0);this.ctx.clearRect(0,0,this.canvas.width,
this.canvas.height);this.ctx.drawImage(this._back_buffer,0,0,this.canvas.width,this.canvas.height)};e.prototype.addMesh=function(c){this.meshes[c.name]=c};e.prototype.removeMesh=function(c){delete this.meshes[c.name]};e.prototype.update=function(){0<this._key_count&&this.fire("keydown");this._needs_update&&(this.renderScene(),this._needs_update=!1);this._anim_id=window.requestAnimationFrame(this.update.bind(this))};q.exports=e},{"../utilities/keycodes.js":11,"../utilities/mixin.js":12,"./camera.js":3,
"./events.js":5,linearalgea:2}],7:[function(f,q,r){r=f("./geometry/geometry.js");f=f("./engine/engine.js");q.exports.geometry=r;q.exports.engine=f},{"./engine/engine.js":4,"./geometry/geometry.js":9}],8:[function(f,q,r){var e=f("colour");q.exports=function(f,l,p,h){this.face=[f,l,p];this.color=new e(h)}},{colour:1}],9:[function(f,q,r){r=f("./mesh.js");f=f("./face.js");q.exports.Mesh=r;q.exports.Face=f},{"./face.js":8,"./mesh.js":10}],10:[function(f,q,r){function e(e,f,c){this.name=e;this.vertices=
f;this.faces=c;this.position=new s(0,0,0);this.rotation={yaw:0,pitch:0,roll:0};this.scale={x:1,y:1,z:1}}var s=f("linearalgea").Vector,l=f("./face.js");e.fromJSON=function(f){for(var h=[],c=[],k=0,g=f.vertices.length;k<g;k++){var a=f.vertices[k];h.push(new s(a[0],a[1],a[2]))}k=0;for(g=f.faces.length;k<g;k++)a=f.faces[k],c.push(new l(a.face[0],a.face[1],a.face[2],a.color));return new e(f.name,h,c)};q.exports=e},{"./face.js":8,linearalgea:2}],11:[function(f,q,r){q.exports={space:32,backspace:8,tab:9,
enter:13,shift:16,ctrl:17,alt:18,pause_break:19,caps_lock:20,escape:27,page_up:33,"page down":34,end:35,home:36,left_arrow:37,up_arrow:38,right_arrow:39,down_arrow:40,insert:45,"delete":46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,"left_window key":91,"right_window key":92,select_key:93,"numpad 0":96,"numpad 1":97,"numpad 2":98,"numpad 3":99,"numpad 4":100,"numpad 5":101,
"numpad 6":102,"numpad 7":103,"numpad 8":104,"numpad 9":105,multiply:106,add:107,subtract:109,"decimal point":110,divide:111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,num_lock:144,scroll_lock:145,semi_colon:186,equal_sign:187,comma:188,dash:189,period:190,forward_slash:191,grave_accent:192,open_bracket:219,backslash:220,closebracket:221,single_quote:222}},{}],12:[function(f,q,r){q.exports=function(e,f){for(var l in f)f.hasOwnProperty(l)&&(e[l]=f[l]);return e}},
{}]},{},[7])(7)});
