/*

 Copyright (c) 2014 Eben Packwood. All rights reserved.
 MIT License


 Copyright (c) 2014 Eben Packwood. All rights reserved.
 MIT License

*/
!function(z){if("object"==typeof exports)module.exports=z();else if("function"==typeof define&&define.amd)define(z);else{var h;"undefined"!=typeof window?h=window:"undefined"!=typeof global?h=global:"undefined"!=typeof self&&(h=self);h.wireframe=z()}}(function(){return function h(q,r,d){function s(k,c){if(!r[k]){if(!q[k]){var l="function"==typeof require&&require;if(!c&&l)return l(k,!0);if(n)return n(k,!0);throw Error("Cannot find module '"+k+"'");}l=r[k]={exports:{}};q[k][0].call(l.exports,function(c){var a=
q[k][1][c];return s(a?a:c)},l,l.exports,h,q,r,d)}return r[k].exports}for(var n="function"==typeof require&&require,p=0;p<d.length;p++)s(d[p]);return s}({1:[function(h,q,r){(function(d){!function(h){if("object"==typeof r)q.exports=h();else{var n;"undefined"!=typeof window?n=window:"undefined"!=typeof d?n=d:"undefined"!=typeof self&&(n=self);n.Colour=h()}}(function(){return function n(d,k,c){function l(a,m){if(!k[a]){if(!d[a]){var b="function"==typeof h&&h;if(!m&&b)return b(a,!0);if(e)return e(a,!0);
throw Error("Cannot find module '"+a+"'");}b=k[a]={exports:{}};d[a][0].call(b.exports,function(b){var c=d[a][1][b];return l(c?c:b)},b,b.exports,n,d,k,c)}return k[a].exports}for(var e="function"==typeof h&&h,a=0;a<c.length;a++)l(c[a]);return l}({1:[function(d,h,k){function c(b,g){var c,t,d={};"string"===typeof b?(b=b.toLowerCase(),b in m?d=m[b]:(d=f(b),m[b]=d),t=d,c=a(d.r,d.g,d.b),g=d.a||g||1):"r"in b?(t=b,c=a(b.r,b.g,b.b),g=c.a||g||1):"h"in b&&(c=b,t=e(b.h,b.s,b.l),g=t.a||g||1);this.rgb={r:t.r,g:t.g,
b:t.b};this.hsl={h:c.h,s:c.s,l:c.l};this.alpha=g}function l(b,g,a){b<g?b=g:b>a&&(b=a);return b}var e,a,f,m;c.prototype.lighten=function(b){var g=this.hsl;b=g.l+b;100<b&&(b=100);return new c({h:g.h,s:g.s,l:b},this.alpha)};c.prototype.darken=function(b){var g=this.hsl;b=g.l-b;0>b&&(b=0);return new c({h:g.h,s:g.s,l:b},this.alpha)};c.prototype.toString=function(){var b=this.rgb.r.toString(16),g=this.rgb.g.toString(16),a=this.rgb.b.toString(16);1===b.length&&(b="0"+b);1===g.length&&(g="0"+g);1===a.length&&
(a="0"+a);return"#"+b+g+a};e=function(b,g,a){function c(b,g,a){0>a&&(a+=1);1<a&&(a-=1);return a<1/6?b+(g-b)*a*6:.5>a?g:a<2/3?b+(g-b)*(2/3-a)*6:b}var f=a/100,e=g/100;if(0===g)return b=255*f,{r:b,g:b,b:b};g=50>=a?f*(1+e):f+e-f*e;f=2*f-g;b/=360;return{r:Math.round(255*c(f,g,b+1/3)),g:Math.round(255*c(f,g,b)),b:Math.round(255*c(f,g,b-1/3))}};a=function(b,g,a){b/=255;g/=255;a/=255;var c=Math.max(b,g,a),f=Math.min(b,g,a),e=Math.round((f+c)/2*100);100<e&&(e=100);0>e&&(e=0);var m;if(f===c)return{h:0,s:0,
l:e};m=50>=e?(c-f)/(c+f):(c-f)/(2-c-f);var d=(c-b)/(c-f),k=(c-g)/(c-f);a=(c-a)/(c-f);b=(b===c?a-k:g===c?2+d-a:4+k-d)/6%1;0>b&&(b+=1);b=Math.round(360*b);m=Math.round(100*m);360<b&&(b=360);0>b&&(b=0);100<m&&(m=100);0>m&&(m=0);return{h:b,s:m,l:e}};f=function(b){var g,a,c,f=1,m,d=!1;m=b.substr(0,3);if("hsl"===m)(m=/hsla?\(\s*(-?\d+)\s*,\s*(-?\d+)%\s*,\s*(-?\d+)%\s*(,\s*(-?\d+(\.\d+)?)\s*)?\)/g.exec(b))?(g=parseInt(m[1],10),a=parseInt(m[2],10),c=parseInt(m[3],10),"a"===b[3]&&(f=parseFloat(m[5])),g=Math.abs(g%
360),a=l(a,0,100),c=l(c,0,100),m=e(g,a,c),g=m.r,a=m.g,c=m.b):d=!0;else if("rgb"===m)if(m=/rgba?\((-?\d+%?)\s*,\s*(-?\d+%?)\s*,\s*(-?\d+%?)(,\s*(-?\d+(\.\d+)?)\s*)?\)/g.exec(b)){var k=m[1],h=m[2],n=m[3];g=parseInt(m[1],10);a=parseInt(m[2],10);c=parseInt(m[3],10);if("%"===k[k.length-1]||"%"===h[h.length-1]||"%"===n[n.length-1])"%"===k[k.length-1]&&"%"===h[h.length-1]&&"%"===n[n.length-1]?(g=Math.floor(g/100*255),a=Math.floor(a/100*255),c=Math.floor(c/100*255)):d=!0;g=l(g,0,255);a=l(a,0,255);c=l(c,0,
255);"a"===b[3]&&(f=parseFloat(m[5]))}else d=!0;else"#"===b[0]?(m=b.substr(1),3===m.length?(g=parseInt(m[0]+m[0],16),a=parseInt(m[1]+m[1],16),c=parseInt(m[2]+m[2],16)):6===m.length?(g=parseInt(m[0]+m[1],16),a=parseInt(m[2]+m[3],16),c=parseInt(m[4]+m[5],16)):d=!0):d=!0;f=l(f,0,1);if(d)throw"ColourError: Something went wrong. Perhaps "+b+" is not a legal CSS color value";return{r:g,g:a,b:c,a:f}};m={black:{r:0,g:0,b:0,h:0,s:0,l:0},silver:{r:192,g:192,b:192,h:0,s:0,l:75},gray:{r:128,g:128,b:128,h:0,s:0,
l:50},white:{r:255,g:255,b:255,h:0,s:0,l:100},maroon:{r:128,g:0,b:0,h:0,s:100,l:25},red:{r:255,g:0,b:0,h:0,s:100,l:50},purple:{r:128,g:0,b:128,h:300,s:100,l:25},fuchsia:{r:255,g:0,b:255,h:300,s:100,l:50},green:{r:0,g:128,b:0,h:120,s:100,l:25},lime:{r:0,g:255,b:0,h:120,s:100,l:50},olive:{r:128,g:128,b:0,h:60,s:100,l:25},yellow:{r:255,g:255,b:0,h:60,s:100,l:50},navy:{r:0,g:0,b:128,h:240,s:100,l:25},blue:{r:0,g:0,b:255,h:240,s:100,l:50},teal:{r:0,g:128,b:128,h:180,s:100,l:25},aqua:{r:0,g:255,b:255,h:180,
s:100,l:50},orange:{r:255,g:165,b:0,h:39,s:100,l:50},aliceblue:{r:240,g:248,b:255,h:208,s:100,l:97},antiquewhite:{r:250,g:235,b:215,h:34,s:78,l:91},aquamarine:{r:127,g:255,b:212,h:160,s:100,l:75},azure:{r:240,g:255,b:255,h:180,s:100,l:97},beige:{r:245,g:245,b:220,h:60,s:56,l:91},bisque:{r:255,g:228,b:196,h:33,s:100,l:88},blanchedalmond:{r:255,g:235,b:205,h:36,s:100,l:90},blueviolet:{r:138,g:43,b:226,h:271,s:76,l:53},brown:{r:165,g:42,b:42,h:0,s:59,l:41},burlywood:{r:222,g:184,b:135,h:34,s:57,l:70},
cadetblue:{r:95,g:158,b:160,h:182,s:25,l:50},chartreuse:{r:127,g:255,b:0,h:90,s:100,l:50},chocolate:{r:210,g:105,b:30,h:25,s:75,l:47},coral:{r:255,g:127,b:80,h:16,s:100,l:66},cornflowerblue:{r:100,g:149,b:237,h:219,s:79,l:66},cornsilk:{r:255,g:248,b:220,h:48,s:100,l:93},cyan:{r:0,g:255,b:255,h:180,s:100,l:97},crimson:{r:220,g:20,b:60,h:348,s:83,l:47},darkblue:{r:0,g:0,b:139,h:240,s:100,l:27},darkcyan:{r:0,g:139,b:139,h:180,s:100,l:27},darkgoldenrod:{r:184,g:134,b:11,h:43,s:89,l:38},darkgray:{r:169,
g:169,b:169,h:0,s:0,l:66},darkgreen:{r:0,g:100,b:0,h:120,s:100,l:20},darkgrey:{r:169,g:169,b:169,h:0,s:0,l:66},darkkhaki:{r:189,g:183,b:107,h:56,s:38,l:58},darkmagenta:{r:139,g:0,b:139,h:300,s:100,l:27},darkolivegreen:{r:85,g:107,b:47,h:82,s:39,l:30},darkorange:{r:255,g:140,b:0,h:33,s:100,l:50},darkorchid:{r:153,g:50,b:204,h:280,s:61,l:50},darkred:{r:139,g:0,b:0,h:0,s:100,l:27},darksalmon:{r:233,g:150,b:122,h:15,s:72,l:70},darkseagreen:{r:143,g:188,b:143,h:120,s:25,l:65},darkslateblue:{r:72,g:61,
b:139,h:248,s:39,l:39},darkslategray:{r:47,g:79,b:79,h:180,s:25,l:25},darkslategrey:{r:47,g:79,b:79,h:180,s:25,l:25},darkturquoise:{r:0,g:206,b:209,h:181,s:100,l:41},darkviolet:{r:148,g:0,b:211,h:282,s:100,l:41},deeppink:{r:255,g:20,b:147,h:328,s:100,l:54},deepskyblue:{r:0,g:191,b:255,h:195,s:100,l:50},dimgray:{r:105,g:105,b:105,h:0,s:0,l:41},dimgrey:{r:105,g:105,b:105,h:0,s:0,l:41},dodgerblue:{r:30,g:144,b:255,h:210,s:100,l:56},firebrick:{r:178,g:34,b:34,h:0,s:68,l:42},floralwhite:{r:255,g:250,b:240,
h:40,s:100,l:97},forestgreen:{r:34,g:139,b:34,h:120,s:61,l:34},gainsboro:{r:220,g:220,b:220,h:0,s:0,l:86},ghostwhite:{r:248,g:248,b:255,h:240,s:100,l:99},gold:{r:255,g:215,b:0,h:51,s:100,l:50},goldenrod:{r:218,g:165,b:32,h:43,s:74,l:49},greenyellow:{r:173,g:255,b:47,h:84,s:100,l:59},grey:{r:128,g:128,b:128,h:0,s:0,l:50},honeydew:{r:240,g:255,b:240,h:120,s:100,l:97},hotpink:{r:255,g:105,b:180,h:330,s:100,l:71},indianred:{r:205,g:92,b:92,h:0,s:53,l:58},indigo:{r:75,g:0,b:130,h:275,s:100,l:25},ivory:{r:255,
g:255,b:240,h:60,s:100,l:97},khaki:{r:240,g:230,b:140,h:54,s:77,l:75},lavender:{r:230,g:230,b:250,h:240,s:67,l:94},lavenderblush:{r:255,g:240,b:245,h:340,s:100,l:97},lawngreen:{r:124,g:252,b:0,h:90,s:100,l:49},lemonchiffon:{r:255,g:250,b:205,h:54,s:100,l:90},lightblue:{r:173,g:216,b:230,h:195,s:53,l:79},lightcoral:{r:240,g:128,b:128,h:0,s:79,l:72},lightcyan:{r:224,g:255,b:255,h:180,s:100,l:94},lightgoldenrodyellow:{r:250,g:250,b:210,h:60,s:80,l:90},lightgray:{r:211,g:211,b:211,h:0,s:0,l:83},lightgreen:{r:144,
g:238,b:144,h:120,s:73,l:75},lightgrey:{r:211,g:211,b:211,h:0,s:0,l:83},lightpink:{r:255,g:182,b:193,h:351,s:100,l:86},lightsalmon:{r:255,g:160,b:122,h:17,s:100,l:74},lightseagreen:{r:32,g:178,b:170,h:177,s:70,l:41},lightskyblue:{r:135,g:206,b:250,h:203,s:92,l:75},lightslategray:{r:119,g:136,b:153,h:210,s:14,l:53},lightslategrey:{r:119,g:136,b:153,h:210,s:14,l:53},lightsteelblue:{r:176,g:196,b:222,h:214,s:41,l:78},lightyellow:{r:255,g:255,b:224,h:60,s:100,l:94},limegreen:{r:50,g:205,b:50,h:120,s:61,
l:50},linen:{r:250,g:240,b:230,h:30,s:67,l:94},magenta:{r:255,g:0,b:255,h:17,s:100,l:74},mediumaquamarine:{r:102,g:205,b:170,h:160,s:51,l:60},mediumblue:{r:0,g:0,b:205,h:240,s:100,l:40},mediumorchid:{r:186,g:85,b:211,h:288,s:59,l:58},mediumpurple:{r:147,g:112,b:219,h:260,s:60,l:65},mediumseagreen:{r:60,g:179,b:113,h:147,s:50,l:47},mediumslateblue:{r:123,g:104,b:238,h:249,s:80,l:67},mediumspringgreen:{r:0,g:250,b:154,h:157,s:100,l:49},mediumturquoise:{r:72,g:209,b:204,h:178,s:60,l:55},mediumvioletred:{r:199,
g:21,b:133,h:322,s:81,l:43},midnightblue:{r:25,g:25,b:112,h:240,s:64,l:27},mintcream:{r:245,g:255,b:250,h:150,s:100,l:98},mistyrose:{r:255,g:228,b:225,h:6,s:100,l:94},moccasin:{r:255,g:228,b:181,h:38,s:100,l:85},navajowhite:{r:255,g:222,b:173,h:36,s:100,l:84},oldlace:{r:253,g:245,b:230,h:39,s:85,l:95},olivedrab:{r:107,g:142,b:35,h:80,s:60,l:35},orangered:{r:255,g:69,b:0,h:16,s:100,l:50},orchid:{r:218,g:112,b:214,h:302,s:59,l:65},palegoldenrod:{r:238,g:232,b:170,h:55,s:67,l:80},palegreen:{r:152,g:251,
b:152,h:120,s:93,l:79},paleturquoise:{r:175,g:238,b:238,h:180,s:65,l:81},palevioletred:{r:219,g:112,b:147,h:340,s:60,l:65},papayawhip:{r:255,g:239,b:213,h:37,s:100,l:92},peachpuff:{r:255,g:218,b:185,h:28,s:100,l:86},peru:{r:205,g:133,b:63,h:30,s:59,l:53},pink:{r:255,g:192,b:203,h:350,s:100,l:88},plum:{r:221,g:160,b:221,h:300,s:47,l:75},powderblue:{r:176,g:224,b:230,h:187,s:52,l:80},rosybrown:{r:188,g:143,b:143,h:0,s:25,l:65},royalblue:{r:65,g:105,b:225,h:225,s:73,l:57},saddlebrown:{r:139,g:69,b:19,
h:25,s:76,l:31},salmon:{r:250,g:128,b:114,h:6,s:93,l:71},sandybrown:{r:244,g:164,b:96,h:28,s:87,l:67},seagreen:{r:46,g:139,b:87,h:146,s:50,l:36},seashell:{r:255,g:245,b:238,h:25,s:100,l:97},sienna:{r:160,g:82,b:45,h:19,s:56,l:40},skyblue:{r:135,g:206,b:235,h:197,s:71,l:73},slateblue:{r:106,g:90,b:205,h:248,s:53,l:58},slategray:{r:112,g:128,b:144,h:210,s:13,l:50},slategrey:{r:112,g:128,b:144,h:210,s:13,l:50},snow:{r:255,g:250,b:250,h:0,s:100,l:99},springgreen:{r:0,g:255,b:127,h:150,s:100,l:50},steelblue:{r:70,
g:130,b:180,h:207,s:44,l:49},tan:{r:210,g:180,b:140,h:34,s:44,l:69},thistle:{r:216,g:191,b:216,h:300,s:24,l:80},tomato:{r:255,g:99,b:71,h:9,s:100,l:64},turquoise:{r:64,g:224,b:208,h:174,s:72,l:56},violet:{r:238,g:130,b:238,h:300,s:76,l:72},wheat:{r:245,g:222,b:179,h:39,s:77,l:83},whitesmoke:{r:245,g:245,b:245,h:0,s:0,l:96},yellowgreen:{r:154,g:205,b:50,h:80,s:61,l:50}};h.exports=c},{}]},{},[1])(1)})}).call(this,"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],2:[function(h,
q,r){(function(d){!function(h){if("object"==typeof r)q.exports=h();else{var n;"undefined"!=typeof window?n=window:"undefined"!=typeof d?n=d:"undefined"!=typeof self&&(n=self);n.linearalgea=h()}}(function(){return function n(d,k,c){function l(a,m){if(!k[a]){if(!d[a]){var b="function"==typeof h&&h;if(!m&&b)return b(a,!0);if(e)return e(a,!0);throw Error("Cannot find module '"+a+"'");}b=k[a]={exports:{}};d[a][0].call(b.exports,function(b){var c=d[a][1][b];return l(c?c:b)},b,b.exports,n,d,k,c)}return k[a].exports}
for(var e="function"==typeof h&&h,a=0;a<c.length;a++)l(c[a]);return l}({1:[function(d,h,k){k=d("./vector.js");d=d("./matrix.js");var c=Object.create(null);c.Vector=k;c.Matrix=d;h.exports=c},{"./matrix.js":2,"./vector.js":3}],2:[function(d,h,k){function c(){for(var b=0;16>b;b++)this[b]=0;this.length=16}d=d("./vector.js");c.prototype.equal=function(b){for(var g=0,a=this.length;g<a;g++)if(this[g]!==b[g])return!1;return!0};c.prototype.add=function(b){for(var g=new c,a=0,f=this.length;a<f;a++)g[a]=this[a]+
b[a];return g};c.prototype.addLG=function(b,g){g[0]=this[0]+b[0];g[1]=this[1]+b[1];g[2]=this[2]+b[2];g[3]=this[3]+b[3];g[4]=this[4]+b[4];g[5]=this[5]+b[5];g[6]=this[6]+b[6];g[7]=this[7]+b[7];g[8]=this[8]+b[8];g[9]=this[9]+b[9];g[10]=this[10]+b[10];g[11]=this[11]+b[11];g[12]=this[12]+b[12];g[13]=this[13]+b[13];g[14]=this[14]+b[14];g[15]=this[15]+b[15];return g};c.prototype.subtract=function(b){for(var g=new c,a=0,f=this.length;a<f;a++)g[a]=this[a]-b[a];return g};c.prototype.subtractLG=function(b,a){a[0]=
this[0]-b[0];a[1]=this[1]-b[1];a[2]=this[2]-b[2];a[3]=this[3]-b[3];a[4]=this[4]-b[4];a[5]=this[5]-b[5];a[6]=this[6]-b[6];a[7]=this[7]-b[7];a[8]=this[8]-b[8];a[9]=this[9]-b[9];a[10]=this[10]-b[10];a[11]=this[11]-b[11];a[12]=this[12]-b[12];a[13]=this[13]-b[13];a[14]=this[14]-b[14];a[15]=this[15]-b[15];return a};c.prototype.multiplyScalar=function(b){for(var a=new c,f=0,e=this.length;f<e;f++)a[f]=this[f]*b;return a};c.prototype.multiplyScalarLG=function(b,a){a[0]=this[0]*b;a[1]=this[1]*b;a[2]=this[2]*
b;a[3]=this[3]*b;a[4]=this[4]*b;a[5]=this[5]*b;a[6]=this[6]*b;a[7]=this[7]*b;a[8]=this[8]*b;a[9]=this[9]*b;a[10]=this[10]*b;a[11]=this[11]*b;a[12]=this[12]*b;a[13]=this[13]*b;a[14]=this[14]*b;a[15]=this[15]*b;return a};c.prototype.multiply=function(b){var a=new c;a[0]=this[0]*b[0]+this[1]*b[4]+this[2]*b[8]+this[3]*b[12];a[1]=this[0]*b[1]+this[1]*b[5]+this[2]*b[9]+this[3]*b[13];a[2]=this[0]*b[2]+this[1]*b[6]+this[2]*b[10]+this[3]*b[14];a[3]=this[0]*b[3]+this[1]*b[7]+this[2]*b[11]+this[3]*b[15];a[4]=
this[4]*b[0]+this[5]*b[4]+this[6]*b[8]+this[7]*b[12];a[5]=this[4]*b[1]+this[5]*b[5]+this[6]*b[9]+this[7]*b[13];a[6]=this[4]*b[2]+this[5]*b[6]+this[6]*b[10]+this[7]*b[14];a[7]=this[4]*b[3]+this[5]*b[7]+this[6]*b[11]+this[7]*b[15];a[8]=this[8]*b[0]+this[9]*b[4]+this[10]*b[8]+this[11]*b[12];a[9]=this[8]*b[1]+this[9]*b[5]+this[10]*b[9]+this[11]*b[13];a[10]=this[8]*b[2]+this[9]*b[6]+this[10]*b[10]+this[11]*b[14];a[11]=this[8]*b[3]+this[9]*b[7]+this[10]*b[11]+this[11]*b[15];a[12]=this[12]*b[0]+this[13]*
b[4]+this[14]*b[8]+this[15]*b[12];a[13]=this[12]*b[1]+this[13]*b[5]+this[14]*b[9]+this[15]*b[13];a[14]=this[12]*b[2]+this[13]*b[6]+this[14]*b[10]+this[15]*b[14];a[15]=this[12]*b[3]+this[13]*b[7]+this[14]*b[11]+this[15]*b[15];return a};c.prototype.multiplyLG=function(b,a){a[0]=this[0]*b[0]+this[1]*b[4]+this[2]*b[8]+this[3]*b[12];a[1]=this[0]*b[1]+this[1]*b[5]+this[2]*b[9]+this[3]*b[13];a[2]=this[0]*b[2]+this[1]*b[6]+this[2]*b[10]+this[3]*b[14];a[3]=this[0]*b[3]+this[1]*b[7]+this[2]*b[11]+this[3]*b[15];
a[4]=this[4]*b[0]+this[5]*b[4]+this[6]*b[8]+this[7]*b[12];a[5]=this[4]*b[1]+this[5]*b[5]+this[6]*b[9]+this[7]*b[13];a[6]=this[4]*b[2]+this[5]*b[6]+this[6]*b[10]+this[7]*b[14];a[7]=this[4]*b[3]+this[5]*b[7]+this[6]*b[11]+this[7]*b[15];a[8]=this[8]*b[0]+this[9]*b[4]+this[10]*b[8]+this[11]*b[12];a[9]=this[8]*b[1]+this[9]*b[5]+this[10]*b[9]+this[11]*b[13];a[10]=this[8]*b[2]+this[9]*b[6]+this[10]*b[10]+this[11]*b[14];a[11]=this[8]*b[3]+this[9]*b[7]+this[10]*b[11]+this[11]*b[15];a[12]=this[12]*b[0]+this[13]*
b[4]+this[14]*b[8]+this[15]*b[12];a[13]=this[12]*b[1]+this[13]*b[5]+this[14]*b[9]+this[15]*b[13];a[14]=this[12]*b[2]+this[13]*b[6]+this[14]*b[10]+this[15]*b[14];a[15]=this[12]*b[3]+this[13]*b[7]+this[14]*b[11]+this[15]*b[15];return a};c.prototype.negate=function(){for(var b=new c,a=0,f=this.length;a<f;a++)b[a]=-this[a];return b};c.prototype.negateLG=function(b){b[0]=-this[0];b[1]=-this[1];b[2]=-this[2];b[3]=-this[3];b[4]=-this[4];b[5]=-this[5];b[6]=-this[6];b[7]=-this[7];b[8]=-this[8];b[9]=-this[9];
b[10]=-this[10];b[11]=-this[11];b[12]=-this[12];b[13]=-this[13];b[14]=-this[14];b[15]=-this[15];return b};c.prototype.transpose=function(){var b=new c;b[0]=this[0];b[1]=this[4];b[2]=this[8];b[3]=this[12];b[4]=this[1];b[5]=this[5];b[6]=this[9];b[7]=this[13];b[8]=this[2];b[9]=this[6];b[10]=this[10];b[11]=this[14];b[12]=this[3];b[13]=this[7];b[14]=this[11];b[15]=this[15];return b};c.prototype.transposeLG=function(b){b[0]=this[0];b[1]=this[4];b[2]=this[8];b[3]=this[12];b[4]=this[1];b[5]=this[5];b[6]=
this[9];b[7]=this[13];b[8]=this[2];b[9]=this[6];b[10]=this[10];b[11]=this[14];b[12]=this[3];b[13]=this[7];b[14]=this[11];b[15]=this[15];return b};c.prototype.empty=function(){for(var b=0,a=this.length;b<a;b++)this[b]=0};c.prototype.copy=function(b){for(var a=0;16>a;a++)b[a]=this[a];return b};c.rotationX=function(b){var a=new c,f=Math.cos(b);b=Math.sin(b);a[0]=1;a[5]=f;a[6]=-b;a[9]=b;a[10]=f;a[15]=1;return a};c.rotationXLG=function(b,a){var c=Math.cos(b),f=Math.sin(b);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=
0;a[5]=c;a[6]=-f;a[7]=0;a[8]=0;a[9]=f;a[10]=c;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};c.rotationY=function(b){var a=new c,f=Math.cos(b);b=Math.sin(b);a[0]=f;a[2]=b;a[5]=1;a[8]=-b;a[10]=f;a[15]=1;return a};c.rotationYLG=function(b,a){var c=Math.cos(b),f=Math.sin(b);a[0]=c;a[1]=0;a[2]=f;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=-f;a[9]=0;a[10]=c;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};c.rotationZ=function(b){var a=new c,f=Math.cos(b);b=Math.sin(b);a[0]=f;a[1]=-b;a[4]=b;a[5]=f;a[10]=
1;a[15]=1;return a};c.rotationZLG=function(b,a){var c=Math.cos(b),f=Math.sin(b);a[0]=c;a[1]=-f;a[2]=0;a[3]=0;a[4]=f;a[5]=c;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};c.rotationAxis=function(b,a){var f=new c,e=b.normalize(),m=Math.sin(a),d=Math.cos(a),k=1-d,l=e.x,h=e.y,e=e.z,n=l*h,p=l*e,q=h*e;f[0]=d+l*l*k;f[1]=n*k-e*m;f[2]=p*k+h*m;f[4]=n*k+e*m;f[5]=d+h*h*k;f[6]=q*k-l*m;f[8]=p*k-h*m;f[9]=q*k+l*m;f[10]=d+e*e*k;f[15]=1;return f};c.rotationAxisLG=function(b,a,
c){b.normalizeLG(m);b=Math.sin(a);a=Math.cos(a);var f=1-a,e=m.x,d=m.y,k=m.z,l=e*d,h=e*k,n=d*k;c[0]=a+e*e*f;c[1]=l*f-k*b;c[2]=h*f+d*b;c[3]=0;c[4]=l*f+k*b;c[5]=a+d*d*f;c[6]=n*f-e*b;c[7]=0;c[8]=h*f-d*b;c[9]=n*f+e*b;c[10]=a+k*k*f;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};c.rotation=function(b,a,f){return c.rotationX(f).multiply(c.rotationZ(a)).multiply(c.rotationY(b))};c.rotationLG=function(b,g,m,d){c.rotationXLG(m,l);c.rotationZLG(g,e);c.rotationYLG(b,a);l.multiplyLG(e,f);f.multiplyLG(a,d);return d};
c.translation=function(b,a,f){var e=c.identity();e[12]=b;e[13]=a;e[14]=f;return e};c.translationLG=function(b,a,c,f){f[0]=1;f[1]=0;f[2]=0;f[3]=0;f[4]=0;f[5]=1;f[6]=0;f[7]=0;f[8]=0;f[9]=0;f[10]=1;f[12]=b;f[13]=a;f[14]=c;f[15]=1;return f};c.scale=function(b,a,f){var e=new c;e[0]=b;e[5]=a;e[10]=f;e[15]=1;return e};c.scaleLG=function(b,a,c,f){f[0]=b;f[1]=0;f[2]=0;f[3]=0;f[4]=0;f[5]=a;f[6]=0;f[7]=0;f[8]=0;f[9]=0;f[10]=c;f[11]=0;f[12]=0;f[13]=0;f[14]=0;f[15]=1;return f};c.identity=function(){var b=new c;
b[0]=1;b[5]=1;b[10]=1;b[15]=1;return b};c.identityLG=function(b){b[0]=1;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=1;b[6]=0;b[7]=0;b[8]=0;b[9]=0;b[10]=1;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};c.zero=function(){return new c};c.zeroLG=function(b){b[0]=0;b[1]=0;b[2]=0;b[3]=0;b[4]=0;b[5]=0;b[6]=0;b[7]=0;b[8]=0;b[9]=0;b[10]=0;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=0;return b};c.fromArray=function(b){for(var a=new c,f=0;16>f;f++)a[f]=b[f];return a};c.fromArrayLG=function(b,a){a[0]=b[0];a[1]=b[1];a[2]=b[2];
a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];a[9]=b[9];a[10]=b[10];a[11]=b[11];a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a};c.copy=function(a,f){for(var c=0;16>c;c++)f[c]=a[c];return f};var l=new c,e=new c,a=new c,f=new c,m=new d(0,0,0);h.exports=c},{"./vector.js":3}],3:[function(d,h,k){function c(a,f,c){if("undefined"===typeof a||"undefined"===typeof f||"undefined"===typeof c)throw Error("Insufficient arguments.");this.x=a;this.y=f;this.z=c}c.prototype.add=function(a){return new c(this.x+
a.x,this.y+a.y,this.z+a.z)};c.prototype.addLG=function(a,c){c.x=this.x+a.x;c.y=this.y+a.y;c.z=this.z+a.z;return c};c.prototype.subtract=function(a){return new c(this.x-a.x,this.y-a.y,this.z-a.z)};c.prototype.subtractLG=function(a,c){c.x=this.x-a.x;c.y=this.y-a.y;c.z=this.z-a.z;return c};c.prototype.equal=function(a){return this.x===a.x&&this.y===a.y&&this.z===a.z};c.prototype.angle=function(a){var c=this.normalize();a=a.normalize();var e=c.magnitude(),b=a.magnitude();if(0===e||0===b)return 0;c=c.dot(a)/
(e*b);-1>c&&(c=-1);1<c&&(c=1);return Math.acos(c)};c.prototype.angleLG=function(a){this.normalizeLG(l);a.normalizeLG(e);a=l.magnitude();var c=e.magnitude();if(0===a||0===c)return 0;a=l.dot(e)/(a*c);-1>a&&(a=-1);1<a&&(a=1);return Math.acos(a)};c.prototype.cosAngle=function(a){var c=this.normalize();a=a.normalize();var e=c.magnitude(),b=a.magnitude();if(0===e||0===b)return 0;c=c.dot(a)/(e*b);-1>c&&(c=-1);1<c&&(c=1);return c};c.prototype.cosAngleLG=function(a){this.normalizeLG(l);a.normalizeLG(e);a=
l.magnitude();var c=e.magnitude();if(0===a||0===c)return 0;a=l.dot(e)/(a*c);-1>a&&(a=-1);1<a&&(a=1);return a};c.prototype.magnitude=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)};c.prototype.magnitudeSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z};c.prototype.dot=function(a){return this.x*a.x+this.y*a.y+this.z*a.z};c.prototype.cross=function(a){return new c(this.y*a.z-this.z*a.y,this.z*a.x-this.x*a.z,this.x*a.y-this.y*a.x)};c.prototype.crossLG=function(a,
c){c.x=this.y*a.z-this.z*a.y;c.y=this.z*a.x-this.x*a.z;c.z=this.x*a.y-this.y*a.x;return c};c.prototype.normalize=function(){var a=this.magnitude();return 0===a?new c(this.x,this.y,this.z):new c(this.x/a,this.y/a,this.z/a)};c.prototype.normalizeLG=function(a){var c=this.magnitude();0===c&&(a.x=this.x,a.y=this.y,a.z=this.z);a.x=this.x/c;a.y=this.y/c;a.z=this.z/c;return a};c.prototype.scale=function(a){return new c(this.x*a,this.y*a,this.z*a)};c.prototype.scaleLG=function(a,c){c.x=this.x*a;c.y=this.y*
a;c.z=this.z*a;return c};c.prototype.negate=function(){return new c(-this.x,-this.y,-this.z)};c.prototype.negateLG=function(a){a.x=-this.x;a.y=-this.y;a.z=-this.z;return a};c.prototype.vectorProjection=function(a){var c=a.magnitude();return a.scale(this.dot(a)/(c*c))};c.prototype.vectorProjectionLG=function(a,c){var e=a.magnitude();a.scaleLG(this.dot(a)/(e*e),c);return c};c.prototype.scalarProjection=function(a){return this.dot(a)/a.magnitude()};c.prototype.transform=function(a){var f=this.x*a[3]+
this.y*a[7]+this.z*a[11]+a[15];return new c((this.x*a[0]+this.y*a[4]+this.z*a[8]+a[12])/f,(this.x*a[1]+this.y*a[5]+this.z*a[9]+a[13])/f,(this.x*a[2]+this.y*a[6]+this.z*a[10]+a[14])/f)};c.prototype.transformLG=function(a,c){var e=this.x*a[1]+this.y*a[5]+this.z*a[9]+a[13],b=this.x*a[2]+this.y*a[6]+this.z*a[10]+a[14],g=this.x*a[3]+this.y*a[7]+this.z*a[11]+a[15];c.x=(this.x*a[0]+this.y*a[4]+this.z*a[8]+a[12])/g;c.y=e/g;c.z=b/g;return c};c.prototype.rotate=function(a,f){var e=a.normalize(),b=Math.sin(f),
g=Math.cos(f),d=1-g,k=e.x,l=e.y,h=e.z,n=e.x*e.y,p=e.x*e.z,e=e.y*e.z;return new c((g+k*k*d)*this.x+(n*d-h*b)*this.y+(p*d+l*b)*this.z,(n*d+h*b)*this.x+(g+l*l*d)*this.y+(e*d-k*b)*this.z,(p*d-l*b)*this.x+(e*d+k*b)*this.y+(g+k*k*d)*this.z)};c.prototype.rotateLG=function(a,c,e){a.normalizeLG(e);a=Math.sin(c);c=Math.cos(c);var b=1-c,g=e.x,d=e.y,k=e.z,l=e.x*e.y,h=e.x*e.z,n=e.y*e.z,p=(l*b+k*a)*this.x+(c+d*d*b)*this.y+(n*b-g*a)*this.z,n=(h*b-d*a)*this.x+(n*b+g*a)*this.y+(c+g*g*b)*this.z;e.x=(c+g*g*b)*this.x+
(l*b-k*a)*this.y+(h*b+d*a)*this.z;e.y=p;e.z=n;return e};c.prototype.rotateX=function(a){var e=Math.sin(a);a=Math.cos(a);return new c(this.x,a*this.y-e*this.z,e*this.y+a*this.z)};c.prototype.rotateXLG=function(a,c){var e=Math.sin(a),b=Math.cos(a),d=b*this.y-e*this.z,e=e*this.y+b*this.z;c.x=this.x;c.y=d;c.z=e;return c};c.prototype.rotateY=function(a){var e=Math.sin(a);a=Math.cos(a);return new c(a*this.x+e*this.z,this.y,-(e*this.x)+a*this.z)};c.prototype.rotateYLG=function(a,c){var e=Math.sin(a),b=Math.cos(a),
d=this.y,k=-(e*this.x)+b*this.z;c.x=b*this.x+e*this.z;c.y=d;c.z=k;return c};c.prototype.rotateZ=function(a){var e=Math.sin(a);a=Math.cos(a);return new c(a*this.x-e*this.y,e*this.x+a*this.y,this.z)};c.prototype.rotateZLG=function(a,c){var e=Math.sin(a),b=Math.cos(a),d=e*this.x+b*this.y,k=this.z;c.x=b*this.x-e*this.y;c.y=d;c.z=k;return c};c.prototype.rotatePitchYawRoll=function(a,c,e){return this.rotateX(e).rotateY(a).rotateZ(c)};c.prototype.rotatePitchYawRollLG=function(a,c,e,b){this.rotateXLG(e,b);
b.rotateYLG(a,b);b.rotateZLG(c,b);return b};var l=new c(0,0,0),e=new c(0,0,0);h.exports=c},{}]},{},[1])(1)})}).call(this,"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],3:[function(h,q,r){function d(d,c,l){this.position=l||new s(1,1,20);this.up=new s(0,1,0);this.rotation={yaw:0,pitch:0,roll:0};this.view_matrix=new n;this.width=d;this.height=c;this.near=.1;this.far=1E3;this.fov=90;this.perspectiveFov=new n;this._xaxis=new s(0,0,0);this._yaxis=new s(0,0,0);this._zaxis=new s(0,
0,0);this._direction=new s(0,0,0);this._temp_vector1=new s(0,0,0);this._temp_vector2=new s(0,0,0);this._temp_matrix=new n;this.calculatePerspectiveFov();this.createViewMatrix()}h=h("linearalgea");var s=h.Vector,n=h.Matrix,p=2*Math.PI;d.prototype.direction=function(){var d=Math.sin(this.rotation.pitch),c=Math.cos(this.rotation.pitch),l=Math.sin(this.rotation.yaw),e=Math.cos(this.rotation.yaw);this._direction.x=-c*l;this._direction.y=d;this._direction.z=-c*e};d.prototype.calculatePerspectiveFov=function(){var d=
this.width/this.height,c=this.near,l=this.far,e=1/Math.tan(Math.PI/180*this.fov/2)*this.height;this.perspectiveFov[0]=e*d;this.perspectiveFov[5]=e;this.perspectiveFov[10]=l/(c-l);this.perspectiveFov[11]=-1;this.perspectiveFov[14]=c*l/(c-l)};d.prototype.createViewMatrix=function(){var d=this.position,c=this.rotation.pitch,l=this.rotation.yaw,e=Math.cos(c),c=Math.sin(c),a=Math.cos(l),l=Math.sin(l);this._xaxis.x=a;this._xaxis.y=0;this._xaxis.z=-l;this._yaxis.x=l*c;this._yaxis.y=e;this._yaxis.z=a*c;this._zaxis.x=
l*e;this._zaxis.y=-c;this._zaxis.z=e*a;n.fromArrayLG([this._xaxis.x,this._yaxis.x,this._zaxis.x,0,this._xaxis.y,this._yaxis.y,this._zaxis.y,0,this._xaxis.z,this._yaxis.z,this._zaxis.z,0,-this._xaxis.dot(d),-this._yaxis.dot(d),-this._zaxis.dot(d),1],this.view_matrix)};d.prototype.look=function(d,c){this.rotation.yaw-=d;0>this.rotation.yaw?this.rotation.yaw+=p:this.rotation.yaw>p&&(this.rotation.yaw-=p);this.rotation.pitch-=c;0>this.rotation.pitch?this.rotation.pitch+=p:this.rotation.pitch>p&&(this.rotation.pitch-=
p);this.createViewMatrix()};d.prototype.turnRight=function(d){this.rotation.yaw-=d;0>this.rotation.yaw&&(this.rotation.yaw+=p);this.createViewMatrix()};d.prototype.turnLeft=function(d){this.rotation.yaw+=d;this.rotation.yaw>p&&(this.rotation.yaw-=p);this.createViewMatrix()};d.prototype.lookUp=function(d){this.rotation.pitch-=d;this.rotation.pitch>p&&(this.rotation.pitch-=p);this.createViewMatrix()};d.prototype.lookDown=function(d){this.rotation.pitch+=d;0>this.rotation.pitch&&(this.rotation.pitch+=
p);this.createViewMatrix()};d.prototype.moveTo=function(d,c,l){this.position.x=d;this.position.y=c;this.position.z=l;this.createViewMatrix()};d.prototype.move=function(d,c,l){this.position.x+=d;this.position.y+=c;this.position.z+=l;this.createViewMatrix()};d.prototype.moveRight=function(d){this.direction();this._direction.normalizeLG(this._temp_vector1);this._temp_vector1.scaleLG(d,this._temp_vector2);this.up.crossLG(this._temp_vector2,this._temp_vector1);this.position.subtractLG(this._temp_vector1,
this.position);this.createViewMatrix()};d.prototype.moveLeft=function(d){this.direction();this._direction.normalizeLG(this._temp_vector1);this._temp_vector1.scaleLG(d,this._temp_vector2);this.up.crossLG(this._temp_vector2,this._temp_vector1);this.position.addLG(this._temp_vector1,this.position);this.createViewMatrix()};d.prototype.moveUp=function(d){this.up.normalizeLG(this._temp_vector1);this._temp_vector1.scaleLG(d,this._temp_vector2);this.position.subtractLG(this._temp_vector2,this.position);this.createViewMatrix()};
d.prototype.moveDown=function(d){this.up.normalizeLG(this._temp_vector1);this._temp_vector1.scaleLG(d,this._temp_vector2);this.position.addLG(this._temp_vector2,this.position);this.createViewMatrix()};d.prototype.moveForward=function(d){this.direction();this._direction.normalizeLG(this._temp_vector1);this._temp_vector1.scaleLG(d,this._temp_vector2);this.position.addLG(this._temp_vector2,this.position);this.createViewMatrix()};d.prototype.moveBackward=function(d){this.direction();this._direction.normalizeLG(this._temp_vector1);
this._temp_vector1.scaleLG(d,this._temp_vector2);this.position.subtractLG(this._temp_vector2,this.position);this.createViewMatrix()};q.exports=d},{linearalgea:2}],4:[function(h,q,r){r=h("./scene.js");h=h("./camera.js");q.exports.Scene=r;q.exports.Camera=h},{"./camera.js":3,"./scene.js":6}],5:[function(h,q,r){q.exports={_listeners:{},addListener:function(d,h){d in this._listeners||(this._listeners[d]=[]);this._listeners[d].push(h)},fire:function(d,h){var n={};"undefined"!==typeof h&&(n=h);n.event=
d;n.target=this;var p=this._listeners[d];if("undefined"!==typeof p)for(var k=0,c=p.length;k<c;k++)p[k].call(this,n)},removeListener:function(d,h){for(var n=this._listeners[d],p=0,k=n.length;p<k;p++)n[p]===h&&n.splice(p,1)}}},{}],6:[function(h,q,r){function d(e){this.width=e.width;this.height=e.height;this.canvas=document.getElementById(e.canvas_id);this.ctx=this.canvas.getContext("2d");this.camera=new s(this.width,this.height);this.illumination=new c(90,0,0);this.meshes={};this._x_offset=Math.round(this.width/
2);this._y_offset=Math.round(this.height/2);this._back_buffer=document.createElement("canvas");this._back_buffer.width=this.width;this._back_buffer.height=this.height;this._back_buffer_ctx=this._back_buffer.getContext("2d");this._back_buffer_image=null;this._depth_buffer=[];this._backface_culling=!0;this._keys={};this._key_count=0;this._anim_id=null;this._needs_update=!0;this._draw_mode=0;this.canvas.tabIndex=1;this._back_buffer_image=this._back_buffer_ctx.createImageData(this.width,this.height);
this.canvas.addEventListener("keydown",this.onKeyDown.bind(this),!1);this.canvas.addEventListener("keyup",this.onKeyUp.bind(this),!1);this.canvas.addEventListener("blur",this.emptyKeys.bind(this),!1);this.canvas.addEventListener("mousedown",this.onMouseDown.bind(this),!1);this.canvas.addEventListener("mouseup",this.onMouseUp.bind(this),!1);this.canvas.addEventListener("mousemove",this.onMouseMove.bind(this),!1);this.initializeDepthBuffer();this.update();this._light_direction=new c(0,0,0);this._wv1=
new l;this._wv2=new l;this._wv3=new l;this._v1=new c(0,0,0);this._v2=new c(0,0,0);this._v3=new c(0,0,0);this._v1t=new c(0,0,0);this._v2t=new c(0,0,0);this._v3t=new c(0,0,0);this._wvp_matrix=new l;this._world_matrix=new l;this._rotation_matrix=new l;this._translation_matrix=new l;this._scale_matrix=new l;this._cam_to_vert=new c(0,0,0);this._temp_matrix=new l;this._side1=new c(0,0,0);this._side2=new c(0,0,0);this._norm=new c(0,0,0)}r=h("linearalgea");var s=h("./camera.js"),n=h("./events.js"),p=h("../utilities/mixin.js"),
k=h("../utilities/keycodes.js"),c=r.Vector,l=r.Matrix;p(d.prototype,n);d.prototype.emptyKeys=function(){this._key_count=0;this._keys={}};d.prototype.isKeyDown=function(c){c=k[c];return c in this._keys&&this._keys[c]};d.prototype.onKeyDown=function(c){c=c.keyCode||c.which;this.isKeyDown(c)||(this._key_count+=1,this._keys[c]=!0)};d.prototype.onKeyUp=function(c){c=c.keyCode||c.which;c in this._keys&&(this._key_count-=1,this._keys[c]=!1)};d.prototype._getMousePos=function(c){var a=this.canvas.getBoundingClientRect();
return{x:c.clientX-a.left,y:c.clientY-a.top}};d.prototype.onMouseDown=function(c){this._last_mouse_update=this._last_mouse_coords=void 0;c={mouse:this._getMousePos(c)};this.fire("mousedown",c);var a=this.onMouseDrag.bind(this),d=function(){this.removeEventListener("mousemove",a,!1);this.removeEventListener("mouseup",d,!1);this._last_mouse_update=this._last_mouse_coords=void 0};this.canvas.addEventListener("mousemove",a,!1);this.canvas.addEventListener("mouseup",d,!1);this.canvas.addEventListener("mouseleave",
d,!1)};d.prototype.onMouseUp=function(c){c={mouse:this._getMousePos(c)};this.fire("mouseup",c)};d.prototype.onMouseMove=function(c){c={mouse:this._getMousePos(c)};this.fire("mousemove",c)};d.prototype.onMouseDrag=function(c){c=this._getMousePos(c);"undefined"===typeof this._last_mouse_coords&&(this._last_mouse_coords=c);"undefined"===typeof this._last_mouse_update&&(this._last_mouse_update=new Date);var a=new Date-this._last_mouse_update,d=c.x-this._last_mouse_coords.x,m=c.y-this._last_mouse_coords.y,
b=0,g=0;0<a&&(b=d/a,g=m/a);d={mouse:{x:c.x,y:c.y,xvel:b,yvel:g,deltax:d,deltay:m}};this._last_mouse_coords=c;this._last_mouse_update=a;this.fire("mousedrag",d)};d.prototype.initializeDepthBuffer=function(){for(var c=0,a=this.width*this.height;c<a;c++)this._depth_buffer[c]=9999999};d.prototype._clear_back_buffer_image=function(){for(var c=this._back_buffer_image.data,a=3;a<c.length;a+=4)c[a]=0};d.prototype.offscreen=function(c){var a=c.x+this._x_offset,d=c.y+this._y_offset;return 1<c.z||0>a||a>this.width||
0>d||d>this.height};d.prototype.toggleDrawMode=function(){this._draw_mode=(this._draw_mode+1)%2;this.renderScene()};d.prototype.toggleBackfaceCulling=function(){this._backface_culling=!this._backface_culling;this.renderScene()};d.prototype.drawPixel=function(c,a,d,m){c+=this._x_offset;a+=this._y_offset;if(0<=c&&c<this.width&&0<=a&&a<this.height&&(c+=a*this.width,d<this._depth_buffer[c])){a=this._back_buffer_image.data;var b=4*c;a[b]=m.r;a[b+1]=m.g;a[b+2]=m.b;a[b+3]=255;this._depth_buffer[c]=d}};d.prototype.drawEdge=
function(c,a,d){var m=Math.abs;if(c.x>=a.x){var b=c;c=a;a=b}var b=c.x,g=c.y,h=c.z,m=Math.max(m(a.x-c.x),m(a.y-c.y),m(a.z-c.z)),l=(a.x-c.x)/m,k=(a.y-c.y)/m;c=(a.z-c.z)/m;for(a=0;a<m;a++)this.drawPixel(Math.floor(b),Math.floor(g),h,d),b+=l,g+=k,h+=c};d.prototype.drawTriangle=function(c,a,d,h){this.drawEdge(c,a,h);this.drawEdge(a,d,h);this.drawEdge(d,c,h)};d.prototype.fillTriangle=function(c,a,d,h){var b=c.x,g=a.x,l=d.x,k=c.y,n=a.y,p=d.y;c=c.z;a=a.z;d=d.z;var q=0-this._x_offset,r=this.width-this._x_offset,
s=0-this._y_offset,u=this.height-this._y_offset,v=Math.floor(Math.min(b,g,l));v<q&&(v=q);q=Math.ceil(Math.max(b,g,l));q>r&&(q=r);r=Math.floor(Math.min(k,n,p));r<s&&(r=s);s=Math.ceil(Math.max(k,n,p));s>u&&(s=u);for(var A=p-k,y=b-l,w=k-n,u=g-b,x=l*k-b*p,b=b*n-g*k,g=A*g+y*n+x,k=w*l+u*p+b,l=A/g,p=y/g,g=x/g,n=w/k,u=u/k,b=b/k;v<=q;v++)for(k=r;k<=s;k++)w=l*v+p*k+g,0<=w&&1>=w&&(x=n*v+u*k+b,0<=x&&1>=x&&(y=1-w-x,0<=y&&1>=y&&this.drawPixel(v,k,y*c+w*a+x*d,h)))};d.prototype.renderScene=function(){this._clear_back_buffer_image();
this.initializeDepthBuffer();var c=this.camera.view_matrix,a=this.camera.perspectiveFov,d=this.illumination,h;for(h in this.meshes)if(this.meshes.hasOwnProperty(h)){var b=this.meshes[h],g=b.scale,k=b.rotation,n=b.position;l.scaleLG(g.x,g.y,g.z,this._scale_matrix);l.rotationLG(k.pitch,k.yaw,k.roll,this._rotation_matrix);l.translationLG(n.x,n.y,n.z,this._translation_matrix);this._scale_matrix.multiplyLG(this._rotation_matrix,this._world_matrix);this._world_matrix.multiplyLG(this._translation_matrix,
this._world_matrix);for(g=0;g<b.faces.length;g++){var p=b.faces[g].face,k=b.faces[g].color,n=b.vertices[p[0]],q=b.vertices[p[1]],p=b.vertices[p[2]];n.transformLG(this._world_matrix,this._v1t);q.transformLG(this._world_matrix,this._v2t);p.transformLG(this._world_matrix,this._v3t);this.camera.position.subtractLG(this._v1t,this._cam_to_vert);this._v2t.subtractLG(this._v1t,this._side1);this._v3t.subtractLG(this._v1t,this._side2);this._side1.crossLG(this._side2,this._norm);1E-8<=this._norm.magnitude()&&
this._norm.normalizeLG(this._norm);if(!this._backface_culling||0<=this._cam_to_vert.dot(this._norm))this._world_matrix.multiplyLG(c,this._temp_matrix),this._temp_matrix.multiplyLG(a,this._wvp_matrix),n.transformLG(this._wvp_matrix,this._wv1),q.transformLG(this._wvp_matrix,this._wv2),p.transformLG(this._wvp_matrix,this._wv3),n=!0,this.offscreen(this._wv1)&&this.offscreen(this._wv2)&&this.offscreen(this._wv3)&&(n=!1),n&&(0===this._draw_mode?this.drawTriangle(this._wv1,this._wv2,this._wv3,k.rgb):1===
this._draw_mode&&(d.subtractLG(this._v1t,this._light_direction),this._light_direction.normalizeLG(this._light_direction),n=this._norm.dot(this._light_direction),k=k.lighten(15*n),this.fillTriangle(this._wv1,this._wv2,this._wv3,k.rgb)))}}this._back_buffer_ctx.putImageData(this._back_buffer_image,0,0);this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);this.ctx.drawImage(this._back_buffer,0,0,this.canvas.width,this.canvas.height)};d.prototype.addMesh=function(c){this.meshes[c.name]=c};d.prototype.removeMesh=
function(c){delete this.meshes[c.name]};d.prototype.update=function(){0<this._key_count&&this.fire("keydown");this._needs_update&&(this.renderScene(),this._needs_update=!1);this._anim_id=window.requestAnimationFrame(this.update.bind(this))};q.exports=d},{"../utilities/keycodes.js":11,"../utilities/mixin.js":12,"./camera.js":3,"./events.js":5,linearalgea:2}],7:[function(h,q,r){r=h("./geometry/geometry.js");h=h("./engine/engine.js");q.exports.geometry=r;q.exports.engine=h},{"./engine/engine.js":4,"./geometry/geometry.js":9}],
8:[function(h,q,r){var d=h("colour");q.exports=function(h,n,p,k){this.face=[h,n,p];this.color=new d(k)}},{colour:1}],9:[function(h,q,r){r=h("./mesh.js");h=h("./face.js");q.exports.Mesh=r;q.exports.Face=h},{"./face.js":8,"./mesh.js":10}],10:[function(h,q,r){function d(d,h,c){this.name=d;this.vertices=h;this.faces=c;this.position=new s(0,0,0);this.rotation={yaw:0,pitch:0,roll:0};this.scale={x:1,y:1,z:1}}var s=h("linearalgea").Vector,n=h("./face.js");d.fromJSON=function(h){for(var k=[],c=[],l=0,e=h.vertices.length;l<
e;l++){var a=h.vertices[l];k.push(new s(a[0],a[1],a[2]))}l=0;for(e=h.faces.length;l<e;l++)a=h.faces[l],c.push(new n(a.face[0],a.face[1],a.face[2],a.color));return new d(h.name,k,c)};q.exports=d},{"./face.js":8,linearalgea:2}],11:[function(h,q,r){q.exports={space:32,backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause_break:19,caps_lock:20,escape:27,page_up:33,"page down":34,end:35,home:36,left_arrow:37,up_arrow:38,right_arrow:39,down_arrow:40,insert:45,"delete":46,0:48,1:49,2:50,3:51,4:52,5:53,
6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,"left_window key":91,"right_window key":92,select_key:93,"numpad 0":96,"numpad 1":97,"numpad 2":98,"numpad 3":99,"numpad 4":100,"numpad 5":101,"numpad 6":102,"numpad 7":103,"numpad 8":104,"numpad 9":105,multiply:106,add:107,subtract:109,"decimal point":110,divide:111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,
num_lock:144,scroll_lock:145,semi_colon:186,equal_sign:187,comma:188,dash:189,period:190,forward_slash:191,grave_accent:192,open_bracket:219,backslash:220,closebracket:221,single_quote:222}},{}],12:[function(h,q,r){q.exports=function(d,h){for(var n in h)h.hasOwnProperty(n)&&(d[n]=h[n]);return d}},{}]},{},[7])(7)});
